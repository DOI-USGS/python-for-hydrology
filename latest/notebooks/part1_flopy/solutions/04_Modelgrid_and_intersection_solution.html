

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>04: Modelgrid and intersection &mdash; Python for Hydrology 1.0a documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />
      <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../../_static/nbsphinx-code-cells.css?v=2aa19091" />

  
      <script src="../../../_static/documentation_options.js?v=feab032e"></script>
      <script src="../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../../../_static/copybutton.js?v=f281be69"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="05: Unstructred Grids" href="../05-unstructured-grids.html" />
    <link rel="prev" title="03: Loading and visualizing groundwater models" href="03_Loading_and_visualizing_models-solutions.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            Python for Hydrology
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Main Curriculum</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../part0.html">     Part 0: Introduction to Python</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../part1.html">Part 1: Flopy</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../01-Flopy-intro.html">01: Introduction to FloPy</a></li>
<li class="toctree-l2"><a class="reference internal" href="02-Building-Post-Processing-MODFLOW6__solutions.html">02: Building and post-processing a MODFLOW 6 model</a></li>
<li class="toctree-l2"><a class="reference internal" href="03_Loading_and_visualizing_models-solutions.html">03: Loading and visualizing groundwater models</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">04: Modelgrid and intersection</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Grids">Grids</a></li>
<li class="toctree-l3"><a class="reference internal" href="#StructuredGrid">StructuredGrid</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#First-we'll-build-one-from-scratch">First we’ll build one from scratch</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Class-exercise-1:">Class exercise 1:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Vertex-model-grid">Vertex model grid</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Create-a-vertex-model-grid-from-the-results">Create a vertex model grid from the results</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Class-Exercise-2:">Class Exercise 2:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#UnstructuredGrid">UnstructuredGrid</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Intersecting-geospatial-data">Intersecting geospatial data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Now-that-the-raster-is-loaded-we-can-resample-it">Now that the raster is loaded we can resample it</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Class-Exercise:-Loading-and-resampling-rasters">Class Exercise: Loading and resampling rasters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Creating-a-UZF-package">Creating a UZF package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Class-Exercise:">Class Exercise:</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#We-can-also-get-daily-discharge-data-to-help-calculate-average-monthly-stages-for-the-RIV-package">We can also get daily discharge data to help calculate average monthly stages for the RIV package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Testing-the-model">Testing the model</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../05-unstructured-grids.html">05: Unstructred Grids</a></li>
<li class="toctree-l2"><a class="reference internal" href="06-Project-structured_completed.html">06: FloPy class project: Structured grid version</a></li>
<li class="toctree-l2"><a class="reference internal" href="06-Project-quadtree.html">06: FloPy class project: Quadtree grid version</a></li>
<li class="toctree-l2"><a class="reference internal" href="06-Project-voronoi.html">06: FloPy class project: Voronoi grid version</a></li>
<li class="toctree-l2"><a class="reference internal" href="07-stream_capture_voronoi.html">07: Evaluating stream capture with a Voronoi grid</a></li>
<li class="toctree-l2"><a class="reference internal" href="../08_Modflow-setup-demo.html">08: Modflow-setup demonstration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../09-gwt-voronoi-demo.html">09: Demonstration of MODFLOW 6 Groundwater Transport with a Voronoi Grid</a></li>
<li class="toctree-l2"><a class="reference internal" href="../10_modpath_particle_tracking-demo.html">10: Particle tracking with MODPATH</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Bonus Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../bonus_examples.html">     General Python</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../SOME_HELPFUL_LINKS.html"> Additional links</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contributing.html"> Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../glossary_of_jargon.html"> Glossary of jargon</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Python for Hydrology</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../part1.html">Part 1 flopy</a></li>
      <li class="breadcrumb-item active">04: Modelgrid and intersection</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/notebooks/part1_flopy/solutions/04_Modelgrid_and_intersection_solution.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="04:-Modelgrid-and-intersection">
<h1>04: Modelgrid and intersection<a class="headerlink" href="#04:-Modelgrid-and-intersection" title="Link to this heading">¶</a></h1>
<p>The first part of this notebook is focused on the <code class="docutils literal notranslate"><span class="pre">flopy.discretization.Grid</span></code> (modelgrid) object(s). The modelgrid object(s) are a relatively new addition to FloPy’s capabilities and are the backbone of plotting, exporting, and GIS data processing within FloPy. These objects are automatically created when a model is loaded. Alternatively they can also be created as a stand alone object.</p>
<p>There are three types of modelgrids:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">StructuredGrid</span></code>: the StructuredGrid object is created for rectilinear grids. i.e. models that use a DIS file for discretization</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">VertexGrid</span></code>: the VertexGrid object is for discretizations that are defined by vertices (e.g., DISV packages)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">UnstructuredGrid</span></code>: the UnstructuredGrid object is for unstructured discretizations (e.g., DISU and MODFLOW-USG)</p></li>
</ul>
<p>These objects all have a common interface defined by the base <code class="docutils literal notranslate"><span class="pre">Grid</span></code> class. What this means for the user is if they want to get the cell center coordinates from a modelgrid, the function call is identical on all three grids.</p>
<p>The best way to learn about these classes is by checking them out.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pl</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">flopy</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">flopy.utils.gridgen</span><span class="w"> </span><span class="kn">import</span> <span class="n">Gridgen</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">flopy.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">GridIntersect</span><span class="p">,</span> <span class="n">Raster</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">geopandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">gpd</span>

<span class="c1"># pd.options.mode.chained_assignment = None</span>
<span class="n">data_path</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;../data/modelgrid_intersection&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<section id="Grids">
<h2>Grids<a class="headerlink" href="#Grids" title="Link to this heading">¶</a></h2>
</section>
<section id="StructuredGrid">
<h2>StructuredGrid<a class="headerlink" href="#StructuredGrid" title="Link to this heading">¶</a></h2>
<p>Let’s start with the most common type of MODFLOW modelgrid, the <code class="docutils literal notranslate"><span class="pre">StructuredGrid</span></code></p>
<section id="First-we'll-build-one-from-scratch">
<h3>First we’ll build one from scratch<a class="headerlink" href="#First-we'll-build-one-from-scratch" title="Link to this heading">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nrow</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">ncol</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">nlay</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">grad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">nrow</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">top</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">nrow</span><span class="p">,</span> <span class="n">ncol</span><span class="p">))</span> <span class="o">*</span> <span class="n">grad</span>
<span class="n">botm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nlay</span><span class="p">,</span> <span class="n">nrow</span><span class="p">,</span> <span class="n">ncol</span><span class="p">))</span>
<span class="n">botm</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">top</span> <span class="o">-</span> <span class="mi">50</span>
<span class="n">delr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">ncol</span><span class="p">,),</span> <span class="mi">250</span><span class="p">)</span>
<span class="n">delc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">nrow</span><span class="p">,),</span> <span class="mi">150</span><span class="p">)</span>
<span class="n">ibound</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">nlay</span><span class="p">,</span> <span class="n">nrow</span><span class="p">,</span> <span class="n">ncol</span><span class="p">))</span>
<span class="n">ibound</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">modelgrid</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">discretization</span><span class="o">.</span><span class="n">StructuredGrid</span><span class="p">(</span>
    <span class="n">delc</span><span class="p">,</span>
    <span class="n">delr</span><span class="p">,</span>
    <span class="n">top</span><span class="p">,</span>
    <span class="n">botm</span><span class="p">,</span>
    <span class="n">ibound</span><span class="p">,</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">modelgrid</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">modelgrid</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
xll:0.0; yll:0.0; rotation:0.0; units:undefined; lenuni:0
&lt;class &#39;flopy.discretization.structuredgrid.StructuredGrid&#39;&gt;
</pre></div></div>
</div>
<p>Let’s take a look at our modelgrid visually</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modelgrid</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_part1_flopy_solutions_04_Modelgrid_and_intersection_solution_6_0.png" src="../../../_images/notebooks_part1_flopy_solutions_04_Modelgrid_and_intersection_solution_6_0.png" />
</div>
</div>
<p>This is great, but what if we want to orient it in space and add a coordinate reference system so we can do further processing?</p>
<p>The <code class="docutils literal notranslate"><span class="pre">set_coord_info()</span></code> method allows us to update the coordinate offsets, rotation of the grid, and even add projection information.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xoff</span> <span class="o">=</span> <span class="mi">2345678</span>
<span class="n">yoff</span> <span class="o">=</span> <span class="mi">1234567</span>
<span class="n">angrot</span> <span class="o">=</span> <span class="o">-</span><span class="mi">15</span>
<span class="n">epsg</span> <span class="o">=</span> <span class="mi">32610</span>  <span class="c1"># utm zone 10N</span>

<span class="n">modelgrid</span><span class="o">.</span><span class="n">set_coord_info</span><span class="p">(</span><span class="n">xoff</span><span class="o">=</span><span class="n">xoff</span><span class="p">,</span> <span class="n">yoff</span><span class="o">=</span><span class="n">yoff</span><span class="p">,</span> <span class="n">angrot</span><span class="o">=</span><span class="n">angrot</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="n">epsg</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">modelgrid</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">modelgrid</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_part1_flopy_solutions_04_Modelgrid_and_intersection_solution_9_0.png" src="../../../_images/notebooks_part1_flopy_solutions_04_Modelgrid_and_intersection_solution_9_0.png" />
</div>
</div>
<section id="Getting-cell-centers-and-cell-vertices">
<h4>Getting cell centers and cell vertices<a class="headerlink" href="#Getting-cell-centers-and-cell-vertices" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p>Cell centers can be returned to the user through the <code class="docutils literal notranslate"><span class="pre">.xcellcenters</span></code>, <code class="docutils literal notranslate"><span class="pre">.ycellcenter</span></code>, and <code class="docutils literal notranslate"><span class="pre">.zcellcenter</span></code> properties.</p></li>
<li><p>Cell vertices can be returned to the user through the <code class="docutils literal notranslate"><span class="pre">.xvertices</span></code> and <code class="docutils literal notranslate"><span class="pre">.yvertices</span></code> properties</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xc</span><span class="p">,</span> <span class="n">yc</span> <span class="o">=</span> <span class="n">modelgrid</span><span class="o">.</span><span class="n">xcellcenters</span><span class="p">,</span> <span class="n">modelgrid</span><span class="o">.</span><span class="n">ycellcenters</span>
<span class="n">xv</span><span class="p">,</span> <span class="n">yv</span> <span class="o">=</span> <span class="n">modelgrid</span><span class="o">.</span><span class="n">xvertices</span><span class="p">,</span> <span class="n">modelgrid</span><span class="o">.</span><span class="n">yvertices</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">modelgrid</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xc</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">yc</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;cell centers&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xv</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">yv</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;cell vertices&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_part1_flopy_solutions_04_Modelgrid_and_intersection_solution_11_0.png" src="../../../_images/notebooks_part1_flopy_solutions_04_Modelgrid_and_intersection_solution_11_0.png" />
</div>
</div>
</section>
<section id="Getting-the-ibound/idomain-array">
<h4>Getting the ibound/idomain array<a class="headerlink" href="#Getting-the-ibound/idomain-array" title="Link to this heading">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">.idomain</span></code> method returns the ibound/idomain array</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ibound</span> <span class="o">=</span> <span class="n">modelgrid</span><span class="o">.</span><span class="n">idomain</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">pmv</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">PlotMapView</span><span class="p">(</span><span class="n">modelgrid</span><span class="o">=</span><span class="n">modelgrid</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">pmv</span><span class="o">.</span><span class="n">plot_grid</span><span class="p">()</span>
<span class="n">pmv</span><span class="o">.</span><span class="n">plot_array</span><span class="p">(</span><span class="n">ibound</span><span class="p">,</span> <span class="n">masked_values</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,]);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_part1_flopy_solutions_04_Modelgrid_and_intersection_solution_13_0.png" src="../../../_images/notebooks_part1_flopy_solutions_04_Modelgrid_and_intersection_solution_13_0.png" />
</div>
</div>
</section>
<section id="Getting-the-model-top,-bottom,-delc,-and-delr">
<h4>Getting the model top, bottom, delc, and delr<a class="headerlink" href="#Getting-the-model-top,-bottom,-delc,-and-delr" title="Link to this heading">¶</a></h4>
<p>The model top, bottom, delc, and delr can be accessed from the modelgrid using <code class="docutils literal notranslate"><span class="pre">.top</span></code>, <code class="docutils literal notranslate"><span class="pre">.bottom</span></code>, <code class="docutils literal notranslate"><span class="pre">.delc</span></code>, and <code class="docutils literal notranslate"><span class="pre">.delr</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">top</span> <span class="o">=</span> <span class="n">modelgrid</span><span class="o">.</span><span class="n">top</span>
<span class="n">botm</span> <span class="o">=</span> <span class="n">modelgrid</span><span class="o">.</span><span class="n">botm</span>
<span class="n">delc</span> <span class="o">=</span> <span class="n">modelgrid</span><span class="o">.</span><span class="n">delc</span>
<span class="n">delr</span> <span class="o">=</span> <span class="n">modelgrid</span><span class="o">.</span><span class="n">delr</span>
<span class="n">top</span><span class="p">,</span> <span class="n">botm</span><span class="p">,</span> <span class="n">delc</span><span class="p">,</span> <span class="n">delr</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(array([[100.        , 100.        , 100.        , 100.        ,
         100.        , 100.        , 100.        , 100.        ,
         100.        , 100.        , 100.        , 100.        ,
         100.        , 100.        , 100.        ],
        [ 97.36842105,  97.36842105,  97.36842105,  97.36842105,
          97.36842105,  97.36842105,  97.36842105,  97.36842105,
          97.36842105,  97.36842105,  97.36842105,  97.36842105,
          97.36842105,  97.36842105,  97.36842105],
        [ 94.73684211,  94.73684211,  94.73684211,  94.73684211,
          94.73684211,  94.73684211,  94.73684211,  94.73684211,
          94.73684211,  94.73684211,  94.73684211,  94.73684211,
          94.73684211,  94.73684211,  94.73684211],
        [ 92.10526316,  92.10526316,  92.10526316,  92.10526316,
          92.10526316,  92.10526316,  92.10526316,  92.10526316,
          92.10526316,  92.10526316,  92.10526316,  92.10526316,
          92.10526316,  92.10526316,  92.10526316],
        [ 89.47368421,  89.47368421,  89.47368421,  89.47368421,
          89.47368421,  89.47368421,  89.47368421,  89.47368421,
          89.47368421,  89.47368421,  89.47368421,  89.47368421,
          89.47368421,  89.47368421,  89.47368421],
        [ 86.84210526,  86.84210526,  86.84210526,  86.84210526,
          86.84210526,  86.84210526,  86.84210526,  86.84210526,
          86.84210526,  86.84210526,  86.84210526,  86.84210526,
          86.84210526,  86.84210526,  86.84210526],
        [ 84.21052632,  84.21052632,  84.21052632,  84.21052632,
          84.21052632,  84.21052632,  84.21052632,  84.21052632,
          84.21052632,  84.21052632,  84.21052632,  84.21052632,
          84.21052632,  84.21052632,  84.21052632],
        [ 81.57894737,  81.57894737,  81.57894737,  81.57894737,
          81.57894737,  81.57894737,  81.57894737,  81.57894737,
          81.57894737,  81.57894737,  81.57894737,  81.57894737,
          81.57894737,  81.57894737,  81.57894737],
        [ 78.94736842,  78.94736842,  78.94736842,  78.94736842,
          78.94736842,  78.94736842,  78.94736842,  78.94736842,
          78.94736842,  78.94736842,  78.94736842,  78.94736842,
          78.94736842,  78.94736842,  78.94736842],
        [ 76.31578947,  76.31578947,  76.31578947,  76.31578947,
          76.31578947,  76.31578947,  76.31578947,  76.31578947,
          76.31578947,  76.31578947,  76.31578947,  76.31578947,
          76.31578947,  76.31578947,  76.31578947],
        [ 73.68421053,  73.68421053,  73.68421053,  73.68421053,
          73.68421053,  73.68421053,  73.68421053,  73.68421053,
          73.68421053,  73.68421053,  73.68421053,  73.68421053,
          73.68421053,  73.68421053,  73.68421053],
        [ 71.05263158,  71.05263158,  71.05263158,  71.05263158,
          71.05263158,  71.05263158,  71.05263158,  71.05263158,
          71.05263158,  71.05263158,  71.05263158,  71.05263158,
          71.05263158,  71.05263158,  71.05263158],
        [ 68.42105263,  68.42105263,  68.42105263,  68.42105263,
          68.42105263,  68.42105263,  68.42105263,  68.42105263,
          68.42105263,  68.42105263,  68.42105263,  68.42105263,
          68.42105263,  68.42105263,  68.42105263],
        [ 65.78947368,  65.78947368,  65.78947368,  65.78947368,
          65.78947368,  65.78947368,  65.78947368,  65.78947368,
          65.78947368,  65.78947368,  65.78947368,  65.78947368,
          65.78947368,  65.78947368,  65.78947368],
        [ 63.15789474,  63.15789474,  63.15789474,  63.15789474,
          63.15789474,  63.15789474,  63.15789474,  63.15789474,
          63.15789474,  63.15789474,  63.15789474,  63.15789474,
          63.15789474,  63.15789474,  63.15789474],
        [ 60.52631579,  60.52631579,  60.52631579,  60.52631579,
          60.52631579,  60.52631579,  60.52631579,  60.52631579,
          60.52631579,  60.52631579,  60.52631579,  60.52631579,
          60.52631579,  60.52631579,  60.52631579],
        [ 57.89473684,  57.89473684,  57.89473684,  57.89473684,
          57.89473684,  57.89473684,  57.89473684,  57.89473684,
          57.89473684,  57.89473684,  57.89473684,  57.89473684,
          57.89473684,  57.89473684,  57.89473684],
        [ 55.26315789,  55.26315789,  55.26315789,  55.26315789,
          55.26315789,  55.26315789,  55.26315789,  55.26315789,
          55.26315789,  55.26315789,  55.26315789,  55.26315789,
          55.26315789,  55.26315789,  55.26315789],
        [ 52.63157895,  52.63157895,  52.63157895,  52.63157895,
          52.63157895,  52.63157895,  52.63157895,  52.63157895,
          52.63157895,  52.63157895,  52.63157895,  52.63157895,
          52.63157895,  52.63157895,  52.63157895],
        [ 50.        ,  50.        ,  50.        ,  50.        ,
          50.        ,  50.        ,  50.        ,  50.        ,
          50.        ,  50.        ,  50.        ,  50.        ,
          50.        ,  50.        ,  50.        ]]),
 array([[[50.        , 50.        , 50.        , 50.        ,
          50.        , 50.        , 50.        , 50.        ,
          50.        , 50.        , 50.        , 50.        ,
          50.        , 50.        , 50.        ],
         [47.36842105, 47.36842105, 47.36842105, 47.36842105,
          47.36842105, 47.36842105, 47.36842105, 47.36842105,
          47.36842105, 47.36842105, 47.36842105, 47.36842105,
          47.36842105, 47.36842105, 47.36842105],
         [44.73684211, 44.73684211, 44.73684211, 44.73684211,
          44.73684211, 44.73684211, 44.73684211, 44.73684211,
          44.73684211, 44.73684211, 44.73684211, 44.73684211,
          44.73684211, 44.73684211, 44.73684211],
         [42.10526316, 42.10526316, 42.10526316, 42.10526316,
          42.10526316, 42.10526316, 42.10526316, 42.10526316,
          42.10526316, 42.10526316, 42.10526316, 42.10526316,
          42.10526316, 42.10526316, 42.10526316],
         [39.47368421, 39.47368421, 39.47368421, 39.47368421,
          39.47368421, 39.47368421, 39.47368421, 39.47368421,
          39.47368421, 39.47368421, 39.47368421, 39.47368421,
          39.47368421, 39.47368421, 39.47368421],
         [36.84210526, 36.84210526, 36.84210526, 36.84210526,
          36.84210526, 36.84210526, 36.84210526, 36.84210526,
          36.84210526, 36.84210526, 36.84210526, 36.84210526,
          36.84210526, 36.84210526, 36.84210526],
         [34.21052632, 34.21052632, 34.21052632, 34.21052632,
          34.21052632, 34.21052632, 34.21052632, 34.21052632,
          34.21052632, 34.21052632, 34.21052632, 34.21052632,
          34.21052632, 34.21052632, 34.21052632],
         [31.57894737, 31.57894737, 31.57894737, 31.57894737,
          31.57894737, 31.57894737, 31.57894737, 31.57894737,
          31.57894737, 31.57894737, 31.57894737, 31.57894737,
          31.57894737, 31.57894737, 31.57894737],
         [28.94736842, 28.94736842, 28.94736842, 28.94736842,
          28.94736842, 28.94736842, 28.94736842, 28.94736842,
          28.94736842, 28.94736842, 28.94736842, 28.94736842,
          28.94736842, 28.94736842, 28.94736842],
         [26.31578947, 26.31578947, 26.31578947, 26.31578947,
          26.31578947, 26.31578947, 26.31578947, 26.31578947,
          26.31578947, 26.31578947, 26.31578947, 26.31578947,
          26.31578947, 26.31578947, 26.31578947],
         [23.68421053, 23.68421053, 23.68421053, 23.68421053,
          23.68421053, 23.68421053, 23.68421053, 23.68421053,
          23.68421053, 23.68421053, 23.68421053, 23.68421053,
          23.68421053, 23.68421053, 23.68421053],
         [21.05263158, 21.05263158, 21.05263158, 21.05263158,
          21.05263158, 21.05263158, 21.05263158, 21.05263158,
          21.05263158, 21.05263158, 21.05263158, 21.05263158,
          21.05263158, 21.05263158, 21.05263158],
         [18.42105263, 18.42105263, 18.42105263, 18.42105263,
          18.42105263, 18.42105263, 18.42105263, 18.42105263,
          18.42105263, 18.42105263, 18.42105263, 18.42105263,
          18.42105263, 18.42105263, 18.42105263],
         [15.78947368, 15.78947368, 15.78947368, 15.78947368,
          15.78947368, 15.78947368, 15.78947368, 15.78947368,
          15.78947368, 15.78947368, 15.78947368, 15.78947368,
          15.78947368, 15.78947368, 15.78947368],
         [13.15789474, 13.15789474, 13.15789474, 13.15789474,
          13.15789474, 13.15789474, 13.15789474, 13.15789474,
          13.15789474, 13.15789474, 13.15789474, 13.15789474,
          13.15789474, 13.15789474, 13.15789474],
         [10.52631579, 10.52631579, 10.52631579, 10.52631579,
          10.52631579, 10.52631579, 10.52631579, 10.52631579,
          10.52631579, 10.52631579, 10.52631579, 10.52631579,
          10.52631579, 10.52631579, 10.52631579],
         [ 7.89473684,  7.89473684,  7.89473684,  7.89473684,
           7.89473684,  7.89473684,  7.89473684,  7.89473684,
           7.89473684,  7.89473684,  7.89473684,  7.89473684,
           7.89473684,  7.89473684,  7.89473684],
         [ 5.26315789,  5.26315789,  5.26315789,  5.26315789,
           5.26315789,  5.26315789,  5.26315789,  5.26315789,
           5.26315789,  5.26315789,  5.26315789,  5.26315789,
           5.26315789,  5.26315789,  5.26315789],
         [ 2.63157895,  2.63157895,  2.63157895,  2.63157895,
           2.63157895,  2.63157895,  2.63157895,  2.63157895,
           2.63157895,  2.63157895,  2.63157895,  2.63157895,
           2.63157895,  2.63157895,  2.63157895],
         [ 0.        ,  0.        ,  0.        ,  0.        ,
           0.        ,  0.        ,  0.        ,  0.        ,
           0.        ,  0.        ,  0.        ,  0.        ,
           0.        ,  0.        ,  0.        ]]]),
 array([150., 150., 150., 150., 150., 150., 150., 150., 150., 150., 150.,
        150., 150., 150., 150., 150., 150., 150., 150., 150.]),
 array([250., 250., 250., 250., 250., 250., 250., 250., 250., 250., 250.,
        250., 250., 250., 250.]))
</pre></div></div>
</div>
</section>
</section>
</section>
<section id="Class-exercise-1:">
<h2>Class exercise 1:<a class="headerlink" href="#Class-exercise-1:" title="Link to this heading">¶</a></h2>
<p>Assume that the modelgrid is currently in meters and we want our grid to be in feet. Create a new modelgrid object from the existing one where the discretization is in feet.</p>
<p>make a plot of the new modelgrid after it has been created</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">conv</span> <span class="o">=</span> <span class="mf">3.28084</span>
<span class="n">mg2</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">discretization</span><span class="o">.</span><span class="n">StructuredGrid</span><span class="p">(</span>
    <span class="n">modelgrid</span><span class="o">.</span><span class="n">delc</span> <span class="o">*</span> <span class="n">conv</span><span class="p">,</span>
    <span class="n">modelgrid</span><span class="o">.</span><span class="n">delr</span> <span class="o">*</span> <span class="n">conv</span><span class="p">,</span>
    <span class="n">modelgrid</span><span class="o">.</span><span class="n">top</span> <span class="o">*</span> <span class="n">conv</span><span class="p">,</span>
    <span class="n">modelgrid</span><span class="o">.</span><span class="n">botm</span> <span class="o">*</span> <span class="n">conv</span><span class="p">,</span>
    <span class="n">modelgrid</span><span class="o">.</span><span class="n">idomain</span><span class="p">,</span>
    <span class="n">xoff</span><span class="o">=</span><span class="n">xoff</span> <span class="o">*</span> <span class="n">conv</span><span class="p">,</span>
    <span class="n">yoff</span><span class="o">=</span><span class="n">yoff</span> <span class="o">*</span> <span class="n">conv</span><span class="p">,</span>
    <span class="n">angrot</span><span class="o">=</span><span class="n">angrot</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mg2</span><span class="p">)</span>
<span class="n">mg2</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
xll:7695794.20952; yll:4050416.79628; rotation:-15; units:undefined; lenuni:0
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_part1_flopy_solutions_04_Modelgrid_and_intersection_solution_17_1.png" src="../../../_images/notebooks_part1_flopy_solutions_04_Modelgrid_and_intersection_solution_17_1.png" />
</div>
</div>
<p>Imagine that we want to find the nearest neighbors of a cell for some reason. The modelgrid has a built in method to 1) internally construct a table of nearest neighbors and 2) return the nearest neighbors for a given cell to the user.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

<span class="n">neighbors</span> <span class="o">=</span> <span class="n">modelgrid</span><span class="o">.</span><span class="n">neighbors</span><span class="p">(</span><span class="o">*</span><span class="n">cell</span><span class="p">)</span>
<span class="n">neighbors</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[(np.int64(0), np.int64(0), np.int64(4)),
 (np.int64(0), np.int64(0), np.int64(6)),
 (np.int64(0), np.int64(1), np.int64(5))]
</pre></div></div>
</div>
<p>If we want to find a cell number based on x, y coordinate location the model grid has a built in <code class="docutils literal notranslate"><span class="pre">.intersect()</span></code> method that takes <code class="docutils literal notranslate"><span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">y</span></code>, and an optional <code class="docutils literal notranslate"><span class="pre">z</span></code> coordinate and returns the cell number</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="mi">2348000</span><span class="p">,</span> <span class="mi">1235000</span><span class="p">,</span> <span class="mi">25</span>

<span class="n">rowcol</span> <span class="o">=</span> <span class="n">modelgrid</span><span class="o">.</span><span class="n">intersect</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="c1"># without z</span>
<span class="n">layrowcol</span> <span class="o">=</span> <span class="n">modelgrid</span><span class="o">.</span><span class="n">intersect</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span> <span class="c1"># with z location</span>

<span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">rowcol</span><span class="si">=}</span><span class="s2">, </span><span class="si">{</span><span class="n">layrowcol</span><span class="si">=}</span><span class="s2">&quot;</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;rowcol=(np.int64(13), np.int64(8)), layrowcol=(0, np.int64(13), np.int64(8))&#39;
</pre></div></div>
</div>
</section>
<section id="Vertex-model-grid">
<h2>Vertex model grid<a class="headerlink" href="#Vertex-model-grid" title="Link to this heading">¶</a></h2>
<p>The vertex model grid is produced for MODFLOW model discretizations that are defined by vertices (<code class="docutils literal notranslate"><span class="pre">DISV</span></code>). We can build a quadtree vertex grid from an exiting structured modelgrid using the gridgen utility and the <code class="docutils literal notranslate"><span class="pre">Gridgen</span></code> class.</p>
<p>First let’s unrotate the grid coordinates of our structured grid to make this easy</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modelgrid</span><span class="o">.</span><span class="n">set_coord_info</span><span class="p">(</span><span class="n">angrot</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">modelgrid</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_part1_flopy_solutions_04_Modelgrid_and_intersection_solution_24_0.png" src="../../../_images/notebooks_part1_flopy_solutions_04_Modelgrid_and_intersection_solution_24_0.png" />
</div>
</div>
<p>Lets load a couple of shapefiles to help with creating the quadtree</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">active_shp</span> <span class="o">=</span> <span class="n">data_path</span> <span class="o">/</span> <span class="s2">&quot;active_area.shp&quot;</span>
<span class="n">refine_shp</span> <span class="o">=</span> <span class="n">data_path</span> <span class="o">/</span> <span class="s2">&quot;refined_area.shp&quot;</span>

<span class="n">active</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">active_shp</span><span class="p">)</span>
<span class="n">refined</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">refine_shp</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Now let’s plot these areas on the grid to visualize them</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="n">pmv</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">PlotMapView</span><span class="p">(</span><span class="n">modelgrid</span><span class="o">=</span><span class="n">modelgrid</span><span class="p">)</span>
<span class="n">pmv</span><span class="o">.</span><span class="n">plot_grid</span><span class="p">()</span>
<span class="c1"># active.geometry.to_list()</span>
<span class="n">pmv</span><span class="o">.</span><span class="n">plot_shapes</span><span class="p">(</span><span class="n">active</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">to_list</span><span class="p">(),</span>  <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;plasma&#39;</span><span class="p">)</span>
<span class="n">pmv</span><span class="o">.</span><span class="n">plot_shapes</span><span class="p">(</span><span class="n">refined</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">to_list</span><span class="p">(),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;magma&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_part1_flopy_solutions_04_Modelgrid_and_intersection_solution_28_0.png" src="../../../_images/notebooks_part1_flopy_solutions_04_Modelgrid_and_intersection_solution_28_0.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">Gridgen</span><span class="p">(</span><span class="n">modelgrid</span><span class="p">,</span> <span class="n">model_ws</span><span class="o">=</span><span class="n">data_path</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">add_refinement_features</span><span class="p">(</span><span class="n">refined</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">to_list</span><span class="p">(),</span> <span class="s2">&quot;polygon&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,])</span>
<span class="n">g</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<section id="Create-a-vertex-model-grid-from-the-results">
<h3>Create a vertex model grid from the results<a class="headerlink" href="#Create-a-vertex-model-grid-from-the-results" title="Link to this heading">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gridprops</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">get_gridprops_vertexgrid</span><span class="p">()</span>
<span class="n">vertexgrid</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">discretization</span><span class="o">.</span><span class="n">VertexGrid</span><span class="p">(</span><span class="o">**</span><span class="n">gridprops</span><span class="p">)</span>
<span class="n">vertexgrid</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_part1_flopy_solutions_04_Modelgrid_and_intersection_solution_32_0.png" src="../../../_images/notebooks_part1_flopy_solutions_04_Modelgrid_and_intersection_solution_32_0.png" />
</div>
</div>
<section id="Getting-the-modelgrid's-shape">
<h4>Getting the modelgrid’s shape<a class="headerlink" href="#Getting-the-modelgrid's-shape" title="Link to this heading">¶</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">shape</span> <span class="o">=</span> <span class="n">vertexgrid</span><span class="o">.</span><span class="n">shape</span>
<span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1, 510)
</pre></div></div>
</div>
</section>
</section>
</section>
<section id="Class-Exercise-2:">
<h2>Class Exercise 2:<a class="headerlink" href="#Class-Exercise-2:" title="Link to this heading">¶</a></h2>
<p>Find and plot all of the nearest neighbors at node 79 on the vertex modelgrid.</p>
<p><strong>Hint</strong>: Use <code class="docutils literal notranslate"><span class="pre">flopy.plot.PlotMapView</span></code> for your plotting, and plot a boolean (1, 0) array with the cells that are not neighbors masked out.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">neighbors</span> <span class="o">=</span> <span class="n">vertexgrid</span><span class="o">.</span><span class="n">neighbors</span><span class="p">(</span><span class="mi">80</span><span class="p">)</span>
<span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">vertexgrid</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="n">arr</span><span class="p">[</span><span class="n">neighbors</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">pmv</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">PlotMapView</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">modelgrid</span><span class="o">=</span><span class="n">vertexgrid</span><span class="p">)</span>
<span class="n">pmv</span><span class="o">.</span><span class="n">plot_grid</span><span class="p">(</span><span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">pmv</span><span class="o">.</span><span class="n">plot_array</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">masked_values</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,]);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_part1_flopy_solutions_04_Modelgrid_and_intersection_solution_36_0.png" src="../../../_images/notebooks_part1_flopy_solutions_04_Modelgrid_and_intersection_solution_36_0.png" />
</div>
</div>
</section>
<section id="UnstructuredGrid">
<h2>UnstructuredGrid<a class="headerlink" href="#UnstructuredGrid" title="Link to this heading">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">UnstructuredGrid</span></code> class is used with MODFLOW-USG and MODFLOW-6 DISU type discretizations. We can also create an <code class="docutils literal notranslate"><span class="pre">UnstructuredGrid</span></code> object from the <code class="docutils literal notranslate"><span class="pre">Gridgen</span></code> results</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gridprops</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">get_gridprops_unstructuredgrid</span><span class="p">()</span>

<span class="n">ugrid</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">discretization</span><span class="o">.</span><span class="n">UnstructuredGrid</span><span class="p">(</span><span class="o">**</span><span class="n">gridprops</span><span class="p">)</span>
<span class="n">ugrid</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">ugrid</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(xll:0.0; yll:0.0; rotation:0.0; units:undefined; lenuni:0,
 flopy.discretization.unstructuredgrid.UnstructuredGrid)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ugrid</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_part1_flopy_solutions_04_Modelgrid_and_intersection_solution_39_0.png" src="../../../_images/notebooks_part1_flopy_solutions_04_Modelgrid_and_intersection_solution_39_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">neighbors</span> <span class="o">=</span> <span class="n">ugrid</span><span class="o">.</span><span class="n">neighbors</span><span class="p">(</span><span class="mi">79</span><span class="p">)</span>
<span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">ugrid</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="n">arr</span><span class="p">[</span><span class="n">neighbors</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="n">pmv</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">PlotMapView</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">modelgrid</span><span class="o">=</span><span class="n">ugrid</span><span class="p">)</span>
<span class="n">pmv</span><span class="o">.</span><span class="n">plot_grid</span><span class="p">()</span>
<span class="n">pmv</span><span class="o">.</span><span class="n">plot_array</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">masked_values</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,]);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_part1_flopy_solutions_04_Modelgrid_and_intersection_solution_40_0.png" src="../../../_images/notebooks_part1_flopy_solutions_04_Modelgrid_and_intersection_solution_40_0.png" />
</div>
</div>
</section>
<section id="Intersecting-geospatial-data">
<h2>Intersecting geospatial data<a class="headerlink" href="#Intersecting-geospatial-data" title="Link to this heading">¶</a></h2>
<p>In this part of the lesson we will intersect geospatial data with a modelgrid and begin building a simple adaptation of the Sagehen Creek model, near Truckee, CA. While building this model, we’ll work with shapefile and raster data. As we build the model FloPy’s intersection capabilities will be presented.</p>
<p>Let’s start by getting the basin boundary. For the Sagehen Creek model, we’re interested in the contributing area for <a class="reference external" href="https://waterdata.usgs.gov/ca/nwis/uv/?site_no=10343500&amp;PARAmeter_cd=00065,00060">USGS gage 10343500</a></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">station_id</span> <span class="o">=</span> <span class="s2">&quot;10343500&quot;</span>
<span class="n">basin</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">data_path</span> <span class="o">/</span> <span class="s2">&quot;sagehen_basin.shp&quot;</span><span class="p">)</span>
<span class="n">basin</span> <span class="o">=</span> <span class="n">basin</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;identifier&quot;</span><span class="p">)</span>
<span class="n">basin</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>geometry</th>
    </tr>
    <tr>
      <th>identifier</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10343500</th>
      <td>POLYGON ((-120.25104 39.40471, -120.25613 39.4...</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>First thing that we notice is that the basin polygon is projected in decimal degrees, which is not good for modeling. An equal area projection would be better suited for this application</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epsg</span> <span class="o">=</span> <span class="mi">26911</span>  <span class="c1"># NAD83 utm zone 11 N, epsg: 26911</span>
<span class="n">basin</span> <span class="o">=</span> <span class="n">basin</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">epsg</span><span class="o">=</span><span class="n">epsg</span><span class="p">)</span>
<span class="n">basin</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>geometry</th>
    </tr>
    <tr>
      <th>identifier</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10343500</th>
      <td>POLYGON ((220068.76 4366733.474, 219647.52 436...</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">basin</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Axes: &gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_part1_flopy_solutions_04_Modelgrid_and_intersection_solution_45_1.png" src="../../../_images/notebooks_part1_flopy_solutions_04_Modelgrid_and_intersection_solution_45_1.png" />
</div>
</div>
<p>We can now get our basin’s bounding box using <code class="docutils literal notranslate"><span class="pre">.bounds</span></code>, buffer it, and then begin creating a modelgrid based on the basin boundary.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cellsize</span> <span class="o">=</span> <span class="mi">90</span>  <span class="c1"># 90 m grid</span>
<span class="n">bounds</span> <span class="o">=</span> <span class="n">basin</span><span class="o">.</span><span class="n">bounds</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span>
<span class="n">xmin</span> <span class="o">=</span> <span class="n">bounds</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">station_id</span><span class="p">,</span> <span class="s2">&quot;minx&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">cellsize</span> <span class="o">*</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ymin</span> <span class="o">=</span> <span class="n">bounds</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">station_id</span><span class="p">,</span> <span class="s2">&quot;miny&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">cellsize</span> <span class="o">*</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">xmax</span> <span class="o">=</span> <span class="n">bounds</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">station_id</span><span class="p">,</span> <span class="s2">&quot;maxx&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">cellsize</span> <span class="o">*</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ymax</span> <span class="o">=</span> <span class="n">bounds</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">station_id</span><span class="p">,</span> <span class="s2">&quot;maxy&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">cellsize</span> <span class="o">*</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                     minx          miny           maxx          maxy
identifier
10343500    214358.622076  4.366733e+06  221497.557955  4.373287e+06
</pre></div></div>
</div>
<p>Calculate the number of rows and columns the model will have and then create a delc and delr array.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dx</span> <span class="o">=</span> <span class="n">xmax</span> <span class="o">-</span> <span class="n">xmin</span>
<span class="n">dy</span> <span class="o">=</span> <span class="n">ymax</span> <span class="o">-</span> <span class="n">ymin</span>

<span class="n">nlay</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">nrow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">dy</span> <span class="o">/</span> <span class="n">cellsize</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">ncol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">dx</span> <span class="o">/</span> <span class="n">cellsize</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">delr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">ncol</span><span class="p">,),</span> <span class="n">cellsize</span><span class="p">)</span>
<span class="n">delc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">nrow</span><span class="p">,),</span> <span class="n">cellsize</span><span class="p">)</span>

<span class="c1"># let&#39;s create a fake top and bottom for now</span>
<span class="n">top</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">nrow</span><span class="p">,</span> <span class="n">ncol</span><span class="p">),</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">botm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">nlay</span><span class="p">,</span> <span class="n">nrow</span><span class="p">,</span> <span class="n">ncol</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Now we can create a minimal modelgrid from the information we have</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modelgrid</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">discretization</span><span class="o">.</span><span class="n">StructuredGrid</span><span class="p">(</span>
    <span class="n">delc</span><span class="p">,</span>
    <span class="n">delr</span><span class="p">,</span>
    <span class="n">top</span><span class="o">=</span><span class="n">top</span><span class="p">,</span>
    <span class="n">botm</span><span class="o">=</span><span class="n">botm</span><span class="p">,</span>
    <span class="n">nlay</span><span class="o">=</span><span class="n">nlay</span><span class="p">,</span>
    <span class="n">xoff</span><span class="o">=</span><span class="n">xmin</span><span class="p">,</span>
    <span class="n">yoff</span><span class="o">=</span><span class="n">ymin</span><span class="p">,</span>
    <span class="n">crs</span><span class="o">=</span><span class="n">epsg</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">modelgrid</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">modelgrid</span><span class="o">.</span><span class="n">is_complete</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
xll:214268.62207605218; yll:4366643.474127463; rotation:0.0; crs:EPSG:26911; units:undefined; lenuni:0
False
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">basin</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">modelgrid</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_part1_flopy_solutions_04_Modelgrid_and_intersection_solution_52_0.png" src="../../../_images/notebooks_part1_flopy_solutions_04_Modelgrid_and_intersection_solution_52_0.png" />
</div>
</div>
<p>Fantastic! The modelgrid has been created and it completely overlays the contributing area.</p>
<p>FloPy has a utility named <code class="docutils literal notranslate"><span class="pre">GridIntersect</span></code> that allows the user to intersect points, polygons, and polylines with modelgrid objects.</p>
<p>In this example, the basin boundary will be intersected with the modelgrid to create the active and inactive extents of the model. The <code class="docutils literal notranslate"><span class="pre">.intersect()</span></code> method returns a numpy recarry with cellids, vertices, cell areas, and shapely polygon objects.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gx</span> <span class="o">=</span> <span class="n">GridIntersect</span><span class="p">(</span><span class="n">modelgrid</span><span class="p">)</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">gx</span><span class="o">.</span><span class="n">intersect</span><span class="p">(</span><span class="n">basin</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">station_id</span><span class="p">,</span> <span class="s2">&quot;geometry&quot;</span><span class="p">])</span>
<span class="n">result</span><span class="o">.</span><span class="n">cellids</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/mnfienen/miniforge3/envs/pyclass/lib/python3.11/site-packages/flopy/utils/gridintersect.py:123: DeprecationWarning: Note `method=&#34;structured&#34;` is deprecated. Pass `method=&#34;vertex&#34;` to silence this warning. This will be the new default in a future release and this keyword argument will be removed.
  warnings.warn(
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([(1, 52), (1, 53), (1, 54), ..., (73, 64), (73, 65), (73, 66)],
      shape=(3587,), dtype=object)
</pre></div></div>
</div>
<p>create the ibound/idomain array (active and inactive model cells)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ibound</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nlay</span><span class="p">,</span> <span class="n">nrow</span><span class="p">,</span> <span class="n">ncol</span><span class="p">))</span>
<span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">result</span><span class="o">.</span><span class="n">cellids</span><span class="p">)</span>
<span class="n">ibound</span><span class="p">[:,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">pmv</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">PlotMapView</span><span class="p">(</span><span class="n">modelgrid</span><span class="o">=</span><span class="n">modelgrid</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">pmv</span><span class="o">.</span><span class="n">plot_grid</span><span class="p">(</span><span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">pmv</span><span class="o">.</span><span class="n">plot_array</span><span class="p">(</span><span class="n">ibound</span><span class="p">,</span> <span class="n">masked_values</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;viridis&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.collections.QuadMesh at 0x165463290&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_part1_flopy_solutions_04_Modelgrid_and_intersection_solution_57_1.png" src="../../../_images/notebooks_part1_flopy_solutions_04_Modelgrid_and_intersection_solution_57_1.png" />
</div>
</div>
<p>FloPy’s <code class="docutils literal notranslate"><span class="pre">Raster</span></code> class allows us to intersect and resample raster data to the model grid. This class is useful for resampling a number of gridded products such as: Digital Elevation Model data, land cover data, and gridded climate data.</p>
<p>The first example of using the <code class="docutils literal notranslate"><span class="pre">Raster</span></code> class will be to resample Digital Elevation Model (DEM) data to define the land surface of the Sagehen model</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dem_file</span> <span class="o">=</span> <span class="n">data_path</span> <span class="o">/</span> <span class="s2">&quot;dem_30m.img&quot;</span>

<span class="n">raster</span> <span class="o">=</span> <span class="n">Raster</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">dem_file</span><span class="p">)</span>
</pre></div>
</div>
</div>
<section id="Now-that-the-raster-is-loaded-we-can-resample-it">
<h3>Now that the raster is loaded we can resample it<a class="headerlink" href="#Now-that-the-raster-is-loaded-we-can-resample-it" title="Link to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">resample_to_grid()</span></code> method performs geostatistics and returns an array in the shape of the modelgrid. Options for resampling include <code class="docutils literal notranslate"><span class="pre">&quot;nearest&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;linear&quot;</span></code> (bilinear), <code class="docutils literal notranslate"><span class="pre">&quot;cubic&quot;</span></code> (bicubic), <code class="docutils literal notranslate"><span class="pre">&quot;max&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;min&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;median&quot;</span></code>, and <code class="docutils literal notranslate"><span class="pre">&quot;mode&quot;</span></code> (most common value).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># let&#39;s get the nearest neighbor elevations</span>
<span class="n">dem_data</span> <span class="o">=</span> <span class="n">raster</span><span class="o">.</span><span class="n">resample_to_grid</span><span class="p">(</span>
    <span class="n">modelgrid</span><span class="p">,</span>
    <span class="n">band</span><span class="o">=</span><span class="n">raster</span><span class="o">.</span><span class="n">bands</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">method</span><span class="o">=</span><span class="s2">&quot;nearest&quot;</span>
<span class="p">)</span>
<span class="n">dem_data</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[2288.88427734, 2273.79296875, 2263.59692383, ..., 2035.27868652,
        2020.77258301, 2011.82592773],
       [2308.66918945, 2301.82080078, 2284.20483398, ..., 2037.7668457 ,
        2022.42944336, 2011.48937988],
       [2326.71118164, 2321.3112793 , 2301.70703125, ..., 2042.32263184,
        2025.94592285, 2015.38793945],
       ...,
       [2207.31152344, 2229.87426758, 2239.453125  , ..., 2112.20751953,
        2095.49414062, 2073.16308594],
       [2176.74121094, 2186.13769531, 2201.04858398, ..., 2095.2331543 ,
        2074.06396484, 2051.18530273],
       [2156.98022461, 2157.87744141, 2164.14770508, ..., 2077.35131836,
        2053.95043945, 2035.44116211]], shape=(75, 82))
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Now let&#39;s plot it up and see what we have</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">pmv</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">PlotMapView</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">modelgrid</span><span class="o">=</span><span class="n">modelgrid</span><span class="p">)</span>

<span class="n">pmv</span><span class="o">.</span><span class="n">plot_grid</span><span class="p">(</span><span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">pc</span> <span class="o">=</span> <span class="n">pmv</span><span class="o">.</span><span class="n">plot_array</span><span class="p">(</span><span class="n">dem_data</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;viridis&quot;</span><span class="p">)</span>
<span class="n">pmv</span><span class="o">.</span><span class="n">plot_array</span><span class="p">(</span><span class="n">ibound</span><span class="p">,</span> <span class="n">masked_values</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;magma&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">pc</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.7</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_part1_flopy_solutions_04_Modelgrid_and_intersection_solution_62_0.png" src="../../../_images/notebooks_part1_flopy_solutions_04_Modelgrid_and_intersection_solution_62_0.png" />
</div>
</div>
<section id="Start-creating-model-files-from-the-data-we've-gathered-so-far.">
<h4>Start creating model files from the data we’ve gathered so far.<a class="headerlink" href="#Start-creating-model-files-from-the-data-we've-gathered-so-far." title="Link to this heading">¶</a></h4>
<p>At this point we have almost everything we need to begin creating a model discretization package. The only thing left to calculate is the model bottom. Let’s assume bedrock 150 m below land surface throughout the basin and begin creating our model.</p>
<p>We’ll first start by creating our simulation object and adding a solver and the time discretization. This model will be a year long with 12 stress periods and a daily time step</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">MFSimulation</span><span class="p">(</span><span class="s2">&quot;sagehen&quot;</span><span class="p">,</span> <span class="n">sim_ws</span><span class="o">=</span><span class="n">data_path</span><span class="p">)</span>
<span class="n">ims</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">ModflowIms</span><span class="p">(</span><span class="n">sim</span><span class="p">,</span> <span class="n">complexity</span><span class="o">=</span><span class="s2">&quot;COMPLEX&quot;</span><span class="p">)</span>
<span class="n">nper</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">perlen</span> <span class="o">=</span> <span class="p">(</span><span class="mi">31</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">)</span>
<span class="n">period_data</span> <span class="o">=</span> <span class="p">[(</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">perlen</span><span class="p">]</span>
<span class="n">tdis</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">ModflowTdis</span><span class="p">(</span>
    <span class="n">sim</span><span class="p">,</span>
    <span class="n">nper</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
    <span class="n">perioddata</span><span class="o">=</span><span class="n">period_data</span><span class="p">,</span>
    <span class="n">time_units</span><span class="o">=</span><span class="s2">&quot;days&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p>Now to create the Groundwater flow model object and add the dis file to it</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gwf</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">ModflowGwf</span><span class="p">(</span>
    <span class="n">sim</span><span class="p">,</span>
    <span class="n">modelname</span><span class="o">=</span><span class="s1">&#39;sagehen&#39;</span><span class="p">,</span>
    <span class="n">save_flows</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># add the dis package</span>
<span class="n">botm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">dem_data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="mi">150</span>
<span class="n">dis</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">ModflowGwfdis</span><span class="p">(</span>
    <span class="n">gwf</span><span class="p">,</span>
    <span class="n">nrow</span><span class="o">=</span><span class="n">modelgrid</span><span class="o">.</span><span class="n">nrow</span><span class="p">,</span>
    <span class="n">ncol</span><span class="o">=</span><span class="n">modelgrid</span><span class="o">.</span><span class="n">ncol</span><span class="p">,</span>
    <span class="n">delr</span><span class="o">=</span><span class="n">modelgrid</span><span class="o">.</span><span class="n">delr</span><span class="p">,</span>
    <span class="n">delc</span><span class="o">=</span><span class="n">modelgrid</span><span class="o">.</span><span class="n">delc</span><span class="p">,</span>
    <span class="n">top</span><span class="o">=</span><span class="n">dem_data</span><span class="p">,</span>
    <span class="n">botm</span><span class="o">=</span><span class="n">botm</span><span class="p">,</span>
    <span class="n">idomain</span><span class="o">=</span><span class="n">ibound</span>
<span class="p">)</span>

<span class="n">gwf</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
name = sagehen
model_type = gwf6
version = mf6
model_relative_path = .

###################
Package dis
###################

package_name = dis
filename = sagehen.dis
package_type = dis
model_or_simulation_package = model
model_name = sagehen


</pre></div></div>
</div>
<p>We can also add an initial conditions file to the model. Let’s assume water level begins at 5 meters below land surface</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ic</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">ModflowGwfic</span><span class="p">(</span><span class="n">gwf</span><span class="p">,</span> <span class="n">strt</span><span class="o">=</span><span class="n">dem_data</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">gwf</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
name = sagehen
model_type = gwf6
version = mf6
model_relative_path = .

###################
Package dis
###################

package_name = dis
filename = sagehen.dis
package_type = dis
model_or_simulation_package = model
model_name = sagehen


###################
Package ic
###################

package_name = ic
filename = sagehen.ic
package_type = ic
model_or_simulation_package = model
model_name = sagehen


</pre></div></div>
</div>
<p>And we can create our NPF and STO packages using values from literature</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">npf</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">ModflowGwfnpf</span><span class="p">(</span>
    <span class="n">gwf</span><span class="p">,</span>
    <span class="n">save_flows</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">save_specific_discharge</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">k</span><span class="o">=</span><span class="mf">0.022</span>  <span class="c1"># value from Larsen et al, 2022</span>
<span class="p">)</span>

<span class="n">sto</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">ModflowGwfsto</span><span class="p">(</span>
    <span class="n">gwf</span><span class="p">,</span>
    <span class="n">save_flows</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">iconvert</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">ss</span><span class="o">=</span><span class="mf">1e-07</span><span class="p">,</span>  <span class="c1"># values from Larsen et al, 2022</span>
    <span class="n">sy</span><span class="o">=</span><span class="mf">0.2</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p>We can also add a OC package now</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># build output control package</span>
<span class="n">budget_file</span> <span class="o">=</span> <span class="s2">&quot;sagehen.cbc&quot;</span>
<span class="n">head_file</span> <span class="o">=</span> <span class="s2">&quot;sagehen.hds&quot;</span>
<span class="n">saverecord</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="p">[(</span><span class="s2">&quot;HEAD&quot;</span><span class="p">,</span> <span class="s2">&quot;ALL&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;BUDGET&quot;</span><span class="p">,</span> <span class="s2">&quot;ALL&quot;</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">gwf</span><span class="o">.</span><span class="n">nper</span><span class="p">)}</span>
<span class="n">oc</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">ModflowGwfoc</span><span class="p">(</span>
    <span class="n">gwf</span><span class="p">,</span>
    <span class="n">budget_filerecord</span><span class="o">=</span><span class="n">budget_file</span><span class="p">,</span>
    <span class="n">head_filerecord</span><span class="o">=</span><span class="n">head_file</span><span class="p">,</span>
    <span class="n">saverecord</span><span class="o">=</span><span class="n">saverecord</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</section>
</section>
</section>
<section id="Class-Exercise:-Loading-and-resampling-rasters">
<h2>Class Exercise: Loading and resampling rasters<a class="headerlink" href="#Class-Exercise:-Loading-and-resampling-rasters" title="Link to this heading">¶</a></h2>
<p>For this exercise we are loading and resampling monthly Daymet climate data for Sagehen basin.</p>
<p>Load the potential evapotranspiration raster <code class="docutils literal notranslate"><span class="pre">pet_raster</span></code> using flopy’s <code class="docutils literal notranslate"><span class="pre">Raster</span></code> class and create a dictionary of resampled PET that stores all 12 months of values.</p>
<p><strong>Hints:</strong></p>
<ul class="simple">
<li><p>Rasters contain multiple datasets called bands, the <code class="docutils literal notranslate"><span class="pre">Raster</span></code> class has a <code class="docutils literal notranslate"><span class="pre">.bands</span></code> attribute that returns a list of all of the bands within the raster. Lists can be looped over!</p></li>
<li><p>Because the data is coarse compared to our model discretization, the nearest neighbor method should be appropriate for resampling <code class="docutils literal notranslate"><span class="pre">method=&quot;nearest&quot;</span></code></p></li>
<li><p>Finally no data values should be converted to 0 value. The <code class="docutils literal notranslate"><span class="pre">Raster</span></code> class has a <code class="docutils literal notranslate"><span class="pre">.nodatavals</span></code> attribute that returns a list of no data values. There is only one in this list; use numpy’s boolean indexing or <code class="docutils literal notranslate"><span class="pre">np.where()</span></code> to replace all of the no data entries with 0.</p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pet_raster</span> <span class="o">=</span> <span class="n">data_path</span> <span class="o">/</span> <span class="s2">&quot;pet.tif&quot;</span>
<span class="n">prcp_raster</span> <span class="o">=</span> <span class="n">data_path</span> <span class="o">/</span> <span class="s2">&quot;prcp.tif&quot;</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rstr</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">Raster</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">pet_raster</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pet_monthly</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">band</span> <span class="ow">in</span> <span class="n">rstr</span><span class="o">.</span><span class="n">bands</span><span class="p">:</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">rstr</span><span class="o">.</span><span class="n">resample_to_grid</span><span class="p">(</span>
        <span class="n">modelgrid</span><span class="p">,</span>
        <span class="n">band</span><span class="p">,</span>
        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;nearest&quot;</span>
    <span class="p">)</span>
    <span class="n">t</span><span class="p">[</span><span class="n">t</span> <span class="o">==</span> <span class="n">rstr</span><span class="o">.</span><span class="n">nodatavals</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">pet_monthly</span><span class="p">[</span><span class="n">band</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span>

<span class="n">pet_monthly</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{0: array([[0.89827865, 0.89827865, 0.89827865, ..., 1.00581992, 1.00581992,
         1.00581992],
        [0.89827865, 0.89827865, 0.89827865, ..., 1.00581992, 1.00581992,
         1.00581992],
        [0.89827865, 0.89827865, 0.89827865, ..., 1.00581992, 1.00581992,
         1.00581992],
        ...,
        [0.        , 0.        , 0.        , ..., 1.01081669, 1.01081669,
         1.01081669],
        [0.        , 0.        , 0.        , ..., 1.01081669, 1.01081669,
         1.01081669],
        [0.        , 0.        , 0.        , ..., 1.01081669, 1.01081669,
         1.01081669]], shape=(75, 82)),
 1: array([[1.31099296, 1.31099296, 1.31099296, ..., 1.42294502, 1.42294502,
         1.42294502],
        [1.31099296, 1.31099296, 1.31099296, ..., 1.42294502, 1.42294502,
         1.42294502],
        [1.31099296, 1.31099296, 1.31099296, ..., 1.42294502, 1.42294502,
         1.42294502],
        ...,
        [0.        , 0.        , 0.        , ..., 1.4494915 , 1.4494915 ,
         1.4494915 ],
        [0.        , 0.        , 0.        , ..., 1.4494915 , 1.4494915 ,
         1.4494915 ],
        [0.        , 0.        , 0.        , ..., 1.4494915 , 1.4494915 ,
         1.4494915 ]], shape=(75, 82)),
 2: array([[1.88199592, 1.88199592, 1.88199592, ..., 2.01319814, 2.01319814,
         2.01319814],
        [1.88199592, 1.88199592, 1.88199592, ..., 2.01319814, 2.01319814,
         2.01319814],
        [1.88199592, 1.88199592, 1.88199592, ..., 2.01319814, 2.01319814,
         2.01319814],
        ...,
        [0.        , 0.        , 0.        , ..., 2.06212258, 2.06212258,
         2.06212258],
        [0.        , 0.        , 0.        , ..., 2.06212258, 2.06212258,
         2.06212258],
        [0.        , 0.        , 0.        , ..., 2.06212258, 2.06212258,
         2.06212258]], shape=(75, 82)),
 3: array([[3.14511275, 3.14511275, 3.14511275, ..., 3.33968782, 3.33968782,
         3.33968782],
        [3.14511275, 3.14511275, 3.14511275, ..., 3.33968782, 3.33968782,
         3.33968782],
        [3.14511275, 3.14511275, 3.14511275, ..., 3.33968782, 3.33968782,
         3.33968782],
        ...,
        [0.        , 0.        , 0.        , ..., 3.41348195, 3.41348195,
         3.41348195],
        [0.        , 0.        , 0.        , ..., 3.41348195, 3.41348195,
         3.41348195],
        [0.        , 0.        , 0.        , ..., 3.41348195, 3.41348195,
         3.41348195]], shape=(75, 82)),
 4: array([[3.94825053, 3.94825053, 3.94825053, ..., 4.04690742, 4.04690742,
         4.04690742],
        [3.94825053, 3.94825053, 3.94825053, ..., 4.04690742, 4.04690742,
         4.04690742],
        [3.94825053, 3.94825053, 3.94825053, ..., 4.04690742, 4.04690742,
         4.04690742],
        ...,
        [0.        , 0.        , 0.        , ..., 4.1060009 , 4.1060009 ,
         4.1060009 ],
        [0.        , 0.        , 0.        , ..., 4.1060009 , 4.1060009 ,
         4.1060009 ],
        [0.        , 0.        , 0.        , ..., 4.1060009 , 4.1060009 ,
         4.1060009 ]], shape=(75, 82)),
 5: array([[4.99552679, 4.99552679, 4.99552679, ..., 5.388381  , 5.388381  ,
         5.388381  ],
        [4.99552679, 4.99552679, 4.99552679, ..., 5.388381  , 5.388381  ,
         5.388381  ],
        [4.99552679, 4.99552679, 4.99552679, ..., 5.388381  , 5.388381  ,
         5.388381  ],
        ...,
        [0.        , 0.        , 0.        , ..., 5.34579992, 5.34579992,
         5.34579992],
        [0.        , 0.        , 0.        , ..., 5.34579992, 5.34579992,
         5.34579992],
        [0.        , 0.        , 0.        , ..., 5.34579992, 5.34579992,
         5.34579992]], shape=(75, 82)),
 6: array([[5.21027994, 5.21027994, 5.21027994, ..., 5.60202217, 5.60202217,
         5.60202217],
        [5.21027994, 5.21027994, 5.21027994, ..., 5.60202217, 5.60202217,
         5.60202217],
        [5.21027994, 5.21027994, 5.21027994, ..., 5.60202217, 5.60202217,
         5.60202217],
        ...,
        [0.        , 0.        , 0.        , ..., 5.58002138, 5.58002138,
         5.58002138],
        [0.        , 0.        , 0.        , ..., 5.58002138, 5.58002138,
         5.58002138],
        [0.        , 0.        , 0.        , ..., 5.58002138, 5.58002138,
         5.58002138]], shape=(75, 82)),
 7: array([[4.54519796, 4.54519796, 4.54519796, ..., 4.94014788, 4.94014788,
         4.94014788],
        [4.54519796, 4.54519796, 4.54519796, ..., 4.94014788, 4.94014788,
         4.94014788],
        [4.54519796, 4.54519796, 4.54519796, ..., 4.94014788, 4.94014788,
         4.94014788],
        ...,
        [0.        , 0.        , 0.        , ..., 4.97207499, 4.97207499,
         4.97207499],
        [0.        , 0.        , 0.        , ..., 4.97207499, 4.97207499,
         4.97207499],
        [0.        , 0.        , 0.        , ..., 4.97207499, 4.97207499,
         4.97207499]], shape=(75, 82)),
 8: array([[3.38186955, 3.38186955, 3.38186955, ..., 3.73335552, 3.73335552,
         3.73335552],
        [3.38186955, 3.38186955, 3.38186955, ..., 3.73335552, 3.73335552,
         3.73335552],
        [3.38186955, 3.38186955, 3.38186955, ..., 3.73335552, 3.73335552,
         3.73335552],
        ...,
        [0.        , 0.        , 0.        , ..., 3.75254512, 3.75254512,
         3.75254512],
        [0.        , 0.        , 0.        , ..., 3.75254512, 3.75254512,
         3.75254512],
        [0.        , 0.        , 0.        , ..., 3.75254512, 3.75254512,
         3.75254512]], shape=(75, 82)),
 9: array([[1.60437179, 1.60437179, 1.60437179, ..., 1.80872381, 1.80872381,
         1.80872381],
        [1.60437179, 1.60437179, 1.60437179, ..., 1.80872381, 1.80872381,
         1.80872381],
        [1.60437179, 1.60437179, 1.60437179, ..., 1.80872381, 1.80872381,
         1.80872381],
        ...,
        [0.        , 0.        , 0.        , ..., 1.84118676, 1.84118676,
         1.84118676],
        [0.        , 0.        , 0.        , ..., 1.84118676, 1.84118676,
         1.84118676],
        [0.        , 0.        , 0.        , ..., 1.84118676, 1.84118676,
         1.84118676]], shape=(75, 82)),
 10: array([[1.23011148, 1.23011148, 1.23011148, ..., 1.41456532, 1.41456532,
         1.41456532],
        [1.23011148, 1.23011148, 1.23011148, ..., 1.41456532, 1.41456532,
         1.41456532],
        [1.23011148, 1.23011148, 1.23011148, ..., 1.41456532, 1.41456532,
         1.41456532],
        ...,
        [0.        , 0.        , 0.        , ..., 1.42739856, 1.42739856,
         1.42739856],
        [0.        , 0.        , 0.        , ..., 1.42739856, 1.42739856,
         1.42739856],
        [0.        , 0.        , 0.        , ..., 1.42739856, 1.42739856,
         1.42739856]], shape=(75, 82)),
 11: array([[0.76984066, 0.76984066, 0.76984066, ..., 0.85954601, 0.85954601,
         0.85954601],
        [0.76984066, 0.76984066, 0.76984066, ..., 0.85954601, 0.85954601,
         0.85954601],
        [0.76984066, 0.76984066, 0.76984066, ..., 0.85954601, 0.85954601,
         0.85954601],
        ...,
        [0.        , 0.        , 0.        , ..., 0.8547039 , 0.8547039 ,
         0.8547039 ],
        [0.        , 0.        , 0.        , ..., 0.8547039 , 0.8547039 ,
         0.8547039 ],
        [0.        , 0.        , 0.        , ..., 0.8547039 , 0.8547039 ,
         0.8547039 ]], shape=(75, 82))}
</pre></div></div>
</div>
<p>Let’s load the saved version of this data, it should be identical to the data that was produced in the exercise.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="n">data_path</span> <span class="o">/</span> <span class="s2">&quot;pet.txt&quot;</span><span class="p">)</span>
<span class="n">arr</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">modelgrid</span><span class="o">.</span><span class="n">nrow</span><span class="p">,</span> <span class="n">modelgrid</span><span class="o">.</span><span class="n">ncol</span><span class="p">)</span>
<span class="n">pet_monthly</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="n">a</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">arr</span><span class="p">)}</span>
<span class="n">pet_monthly</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{0: array([[0.89827865, 0.89827865, 0.89827865, ..., 1.00581992, 1.00581992,
         1.00581992],
        [0.89827865, 0.89827865, 0.89827865, ..., 1.00581992, 1.00581992,
         1.00581992],
        [0.89827865, 0.89827865, 0.89827865, ..., 1.00581992, 1.00581992,
         1.00581992],
        ...,
        [0.        , 0.        , 0.        , ..., 1.01081669, 1.01081669,
         1.01081669],
        [0.        , 0.        , 0.        , ..., 1.01081669, 1.01081669,
         1.01081669],
        [0.        , 0.        , 0.        , ..., 1.01081669, 1.01081669,
         1.01081669]], shape=(75, 82)),
 1: array([[1.31099296, 1.31099296, 1.31099296, ..., 1.42294502, 1.42294502,
         1.42294502],
        [1.31099296, 1.31099296, 1.31099296, ..., 1.42294502, 1.42294502,
         1.42294502],
        [1.31099296, 1.31099296, 1.31099296, ..., 1.42294502, 1.42294502,
         1.42294502],
        ...,
        [0.        , 0.        , 0.        , ..., 1.4494915 , 1.4494915 ,
         1.4494915 ],
        [0.        , 0.        , 0.        , ..., 1.4494915 , 1.4494915 ,
         1.4494915 ],
        [0.        , 0.        , 0.        , ..., 1.4494915 , 1.4494915 ,
         1.4494915 ]], shape=(75, 82)),
 2: array([[1.88199592, 1.88199592, 1.88199592, ..., 2.01319814, 2.01319814,
         2.01319814],
        [1.88199592, 1.88199592, 1.88199592, ..., 2.01319814, 2.01319814,
         2.01319814],
        [1.88199592, 1.88199592, 1.88199592, ..., 2.01319814, 2.01319814,
         2.01319814],
        ...,
        [0.        , 0.        , 0.        , ..., 2.06212258, 2.06212258,
         2.06212258],
        [0.        , 0.        , 0.        , ..., 2.06212258, 2.06212258,
         2.06212258],
        [0.        , 0.        , 0.        , ..., 2.06212258, 2.06212258,
         2.06212258]], shape=(75, 82)),
 3: array([[3.14511275, 3.14511275, 3.14511275, ..., 3.33968782, 3.33968782,
         3.33968782],
        [3.14511275, 3.14511275, 3.14511275, ..., 3.33968782, 3.33968782,
         3.33968782],
        [3.14511275, 3.14511275, 3.14511275, ..., 3.33968782, 3.33968782,
         3.33968782],
        ...,
        [0.        , 0.        , 0.        , ..., 3.41348195, 3.41348195,
         3.41348195],
        [0.        , 0.        , 0.        , ..., 3.41348195, 3.41348195,
         3.41348195],
        [0.        , 0.        , 0.        , ..., 3.41348195, 3.41348195,
         3.41348195]], shape=(75, 82)),
 4: array([[3.94825053, 3.94825053, 3.94825053, ..., 4.04690742, 4.04690742,
         4.04690742],
        [3.94825053, 3.94825053, 3.94825053, ..., 4.04690742, 4.04690742,
         4.04690742],
        [3.94825053, 3.94825053, 3.94825053, ..., 4.04690742, 4.04690742,
         4.04690742],
        ...,
        [0.        , 0.        , 0.        , ..., 4.1060009 , 4.1060009 ,
         4.1060009 ],
        [0.        , 0.        , 0.        , ..., 4.1060009 , 4.1060009 ,
         4.1060009 ],
        [0.        , 0.        , 0.        , ..., 4.1060009 , 4.1060009 ,
         4.1060009 ]], shape=(75, 82)),
 5: array([[4.99552679, 4.99552679, 4.99552679, ..., 5.388381  , 5.388381  ,
         5.388381  ],
        [4.99552679, 4.99552679, 4.99552679, ..., 5.388381  , 5.388381  ,
         5.388381  ],
        [4.99552679, 4.99552679, 4.99552679, ..., 5.388381  , 5.388381  ,
         5.388381  ],
        ...,
        [0.        , 0.        , 0.        , ..., 5.34579992, 5.34579992,
         5.34579992],
        [0.        , 0.        , 0.        , ..., 5.34579992, 5.34579992,
         5.34579992],
        [0.        , 0.        , 0.        , ..., 5.34579992, 5.34579992,
         5.34579992]], shape=(75, 82)),
 6: array([[5.21027994, 5.21027994, 5.21027994, ..., 5.60202217, 5.60202217,
         5.60202217],
        [5.21027994, 5.21027994, 5.21027994, ..., 5.60202217, 5.60202217,
         5.60202217],
        [5.21027994, 5.21027994, 5.21027994, ..., 5.60202217, 5.60202217,
         5.60202217],
        ...,
        [0.        , 0.        , 0.        , ..., 5.58002138, 5.58002138,
         5.58002138],
        [0.        , 0.        , 0.        , ..., 5.58002138, 5.58002138,
         5.58002138],
        [0.        , 0.        , 0.        , ..., 5.58002138, 5.58002138,
         5.58002138]], shape=(75, 82)),
 7: array([[4.54519796, 4.54519796, 4.54519796, ..., 4.94014788, 4.94014788,
         4.94014788],
        [4.54519796, 4.54519796, 4.54519796, ..., 4.94014788, 4.94014788,
         4.94014788],
        [4.54519796, 4.54519796, 4.54519796, ..., 4.94014788, 4.94014788,
         4.94014788],
        ...,
        [0.        , 0.        , 0.        , ..., 4.97207499, 4.97207499,
         4.97207499],
        [0.        , 0.        , 0.        , ..., 4.97207499, 4.97207499,
         4.97207499],
        [0.        , 0.        , 0.        , ..., 4.97207499, 4.97207499,
         4.97207499]], shape=(75, 82)),
 8: array([[3.38186955, 3.38186955, 3.38186955, ..., 3.73335552, 3.73335552,
         3.73335552],
        [3.38186955, 3.38186955, 3.38186955, ..., 3.73335552, 3.73335552,
         3.73335552],
        [3.38186955, 3.38186955, 3.38186955, ..., 3.73335552, 3.73335552,
         3.73335552],
        ...,
        [0.        , 0.        , 0.        , ..., 3.75254512, 3.75254512,
         3.75254512],
        [0.        , 0.        , 0.        , ..., 3.75254512, 3.75254512,
         3.75254512],
        [0.        , 0.        , 0.        , ..., 3.75254512, 3.75254512,
         3.75254512]], shape=(75, 82)),
 9: array([[1.60437179, 1.60437179, 1.60437179, ..., 1.80872381, 1.80872381,
         1.80872381],
        [1.60437179, 1.60437179, 1.60437179, ..., 1.80872381, 1.80872381,
         1.80872381],
        [1.60437179, 1.60437179, 1.60437179, ..., 1.80872381, 1.80872381,
         1.80872381],
        ...,
        [0.        , 0.        , 0.        , ..., 1.84118676, 1.84118676,
         1.84118676],
        [0.        , 0.        , 0.        , ..., 1.84118676, 1.84118676,
         1.84118676],
        [0.        , 0.        , 0.        , ..., 1.84118676, 1.84118676,
         1.84118676]], shape=(75, 82)),
 10: array([[1.23011148, 1.23011148, 1.23011148, ..., 1.41456532, 1.41456532,
         1.41456532],
        [1.23011148, 1.23011148, 1.23011148, ..., 1.41456532, 1.41456532,
         1.41456532],
        [1.23011148, 1.23011148, 1.23011148, ..., 1.41456532, 1.41456532,
         1.41456532],
        ...,
        [0.        , 0.        , 0.        , ..., 1.42739856, 1.42739856,
         1.42739856],
        [0.        , 0.        , 0.        , ..., 1.42739856, 1.42739856,
         1.42739856],
        [0.        , 0.        , 0.        , ..., 1.42739856, 1.42739856,
         1.42739856]], shape=(75, 82)),
 11: array([[0.76984066, 0.76984066, 0.76984066, ..., 0.85954601, 0.85954601,
         0.85954601],
        [0.76984066, 0.76984066, 0.76984066, ..., 0.85954601, 0.85954601,
         0.85954601],
        [0.76984066, 0.76984066, 0.76984066, ..., 0.85954601, 0.85954601,
         0.85954601],
        ...,
        [0.        , 0.        , 0.        , ..., 0.8547039 , 0.8547039 ,
         0.8547039 ],
        [0.        , 0.        , 0.        , ..., 0.8547039 , 0.8547039 ,
         0.8547039 ],
        [0.        , 0.        , 0.        , ..., 0.8547039 , 0.8547039 ,
         0.8547039 ]], shape=(75, 82))}
</pre></div></div>
</div>
<p>And resample the precipitation raster we saved earlier</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rstr</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">Raster</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">prcp_raster</span><span class="p">)</span>
<span class="n">prcp_monthly</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">band</span> <span class="ow">in</span> <span class="n">rstr</span><span class="o">.</span><span class="n">bands</span><span class="p">:</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">rstr</span><span class="o">.</span><span class="n">resample_to_grid</span><span class="p">(</span>
        <span class="n">modelgrid</span><span class="p">,</span>
        <span class="n">band</span><span class="p">,</span>
        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;nearest&quot;</span>
    <span class="p">)</span>
    <span class="n">t</span><span class="p">[</span><span class="n">t</span> <span class="o">==</span> <span class="n">rstr</span><span class="o">.</span><span class="n">nodatavals</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">prcp_monthly</span><span class="p">[</span><span class="n">band</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span>

<span class="n">prcp_monthly</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{0: array([[4.47806406, 4.47806406, 4.47806406, ..., 3.39419365, 3.39419365,
         3.39419365],
        [4.47806406, 4.47806406, 4.47806406, ..., 3.39419365, 3.39419365,
         3.39419365],
        [4.47806406, 4.47806406, 4.47806406, ..., 3.39419365, 3.39419365,
         3.39419365],
        ...,
        [0.        , 0.        , 0.        , ..., 4.0393548 , 4.0393548 ,
         4.0393548 ],
        [0.        , 0.        , 0.        , ..., 4.0393548 , 4.0393548 ,
         4.0393548 ],
        [0.        , 0.        , 0.        , ..., 4.0393548 , 4.0393548 ,
         4.0393548 ]], shape=(75, 82)),
 1: array([[2.36392856, 2.36392856, 2.36392856, ..., 1.75142848, 1.75142848,
         1.75142848],
        [2.36392856, 2.36392856, 2.36392856, ..., 1.75142848, 1.75142848,
         1.75142848],
        [2.36392856, 2.36392856, 2.36392856, ..., 1.75142848, 1.75142848,
         1.75142848],
        ...,
        [0.        , 0.        , 0.        , ..., 2.35964322, 2.35964322,
         2.35964322],
        [0.        , 0.        , 0.        , ..., 2.35964322, 2.35964322,
         2.35964322],
        [0.        , 0.        , 0.        , ..., 2.35964322, 2.35964322,
         2.35964322]], shape=(75, 82)),
 2: array([[2.12096763, 2.12096763, 2.12096763, ..., 1.53064525, 1.53064525,
         1.53064525],
        [2.12096763, 2.12096763, 2.12096763, ..., 1.53064525, 1.53064525,
         1.53064525],
        [2.12096763, 2.12096763, 2.12096763, ..., 1.53064525, 1.53064525,
         1.53064525],
        ...,
        [0.        , 0.        , 0.        , ..., 1.75612891, 1.75612891,
         1.75612891],
        [0.        , 0.        , 0.        , ..., 1.75612891, 1.75612891,
         1.75612891],
        [0.        , 0.        , 0.        , ..., 1.75612891, 1.75612891,
         1.75612891]], shape=(75, 82)),
 3: array([[0.597     , 0.597     , 0.597     , ..., 0.46433336, 0.46433336,
         0.46433336],
        [0.597     , 0.597     , 0.597     , ..., 0.46433336, 0.46433336,
         0.46433336],
        [0.597     , 0.597     , 0.597     , ..., 0.46433336, 0.46433336,
         0.46433336],
        ...,
        [0.        , 0.        , 0.        , ..., 0.53933334, 0.53933334,
         0.53933334],
        [0.        , 0.        , 0.        , ..., 0.53933334, 0.53933334,
         0.53933334],
        [0.        , 0.        , 0.        , ..., 0.53933334, 0.53933334,
         0.53933334]], shape=(75, 82)),
 4: array([[0.78161287, 0.78161287, 0.78161287, ..., 0.80645162, 0.80645162,
         0.80645162],
        [0.78161287, 0.78161287, 0.78161287, ..., 0.80645162, 0.80645162,
         0.80645162],
        [0.78161287, 0.78161287, 0.78161287, ..., 0.80645162, 0.80645162,
         0.80645162],
        ...,
        [0.        , 0.        , 0.        , ..., 0.79193544, 0.79193544,
         0.79193544],
        [0.        , 0.        , 0.        , ..., 0.79193544, 0.79193544,
         0.79193544],
        [0.        , 0.        , 0.        , ..., 0.79193544, 0.79193544,
         0.79193544]], shape=(75, 82)),
 5: array([[0.24333334, 0.24333334, 0.24333334, ..., 0.14833333, 0.14833333,
         0.14833333],
        [0.24333334, 0.24333334, 0.24333334, ..., 0.14833333, 0.14833333,
         0.14833333],
        [0.24333334, 0.24333334, 0.24333334, ..., 0.14833333, 0.14833333,
         0.14833333],
        ...,
        [0.        , 0.        , 0.        , ..., 0.14933333, 0.14933333,
         0.14933333],
        [0.        , 0.        , 0.        , ..., 0.14933333, 0.14933333,
         0.14933333],
        [0.        , 0.        , 0.        , ..., 0.14933333, 0.14933333,
         0.14933333]], shape=(75, 82)),
 6: array([[0.20354839, 0.20354839, 0.20354839, ..., 0.20645161, 0.20645161,
         0.20645161],
        [0.20354839, 0.20354839, 0.20354839, ..., 0.20645161, 0.20645161,
         0.20645161],
        [0.20354839, 0.20354839, 0.20354839, ..., 0.20645161, 0.20645161,
         0.20645161],
        ...,
        [0.        , 0.        , 0.        , ..., 0.20451613, 0.20451613,
         0.20451613],
        [0.        , 0.        , 0.        , ..., 0.20451613, 0.20451613,
         0.20451613],
        [0.        , 0.        , 0.        , ..., 0.20451613, 0.20451613,
         0.20451613]], shape=(75, 82)),
 7: array([[0.08483871, 0.08483871, 0.08483871, ..., 0.11064516, 0.11064516,
         0.11064516],
        [0.08483871, 0.08483871, 0.08483871, ..., 0.11064516, 0.11064516,
         0.11064516],
        [0.08483871, 0.08483871, 0.08483871, ..., 0.11064516, 0.11064516,
         0.11064516],
        ...,
        [0.        , 0.        , 0.        , ..., 0.        , 0.        ,
         0.        ],
        [0.        , 0.        , 0.        , ..., 0.        , 0.        ,
         0.        ],
        [0.        , 0.        , 0.        , ..., 0.        , 0.        ,
         0.        ]], shape=(75, 82)),
 8: array([[0.30833334, 0.30833334, 0.30833334, ..., 0.22766666, 0.22766666,
         0.22766666],
        [0.30833334, 0.30833334, 0.30833334, ..., 0.22766666, 0.22766666,
         0.22766666],
        [0.30833334, 0.30833334, 0.30833334, ..., 0.22766666, 0.22766666,
         0.22766666],
        ...,
        [0.        , 0.        , 0.        , ..., 0.48166665, 0.48166665,
         0.48166665],
        [0.        , 0.        , 0.        , ..., 0.48166665, 0.48166665,
         0.48166665],
        [0.        , 0.        , 0.        , ..., 0.48166665, 0.48166665,
         0.48166665]], shape=(75, 82)),
 9: array([[9.75677395, 9.75677395, 9.75677395, ..., 8.6554842 , 8.6554842 ,
         8.6554842 ],
        [9.75677395, 9.75677395, 9.75677395, ..., 8.6554842 , 8.6554842 ,
         8.6554842 ],
        [9.75677395, 9.75677395, 9.75677395, ..., 8.6554842 , 8.6554842 ,
         8.6554842 ],
        ...,
        [0.        , 0.        , 0.        , ..., 8.43290234, 8.43290234,
         8.43290234],
        [0.        , 0.        , 0.        , ..., 8.43290234, 8.43290234,
         8.43290234],
        [0.        , 0.        , 0.        , ..., 8.43290234, 8.43290234,
         8.43290234]], shape=(75, 82)),
 10: array([[1.15666664, 1.15666664, 1.15666664, ..., 0.90833336, 0.90833336,
         0.90833336],
        [1.15666664, 1.15666664, 1.15666664, ..., 0.90833336, 0.90833336,
         0.90833336],
        [1.15666664, 1.15666664, 1.15666664, ..., 0.90833336, 0.90833336,
         0.90833336],
        ...,
        [0.        , 0.        , 0.        , ..., 1.10366654, 1.10366654,
         1.10366654],
        [0.        , 0.        , 0.        , ..., 1.10366654, 1.10366654,
         1.10366654],
        [0.        , 0.        , 0.        , ..., 1.10366654, 1.10366654,
         1.10366654]], shape=(75, 82)),
 11: array([[11.07774162, 11.07774162, 11.07774162, ...,  9.146451  ,
          9.146451  ,  9.146451  ],
        [11.07774162, 11.07774162, 11.07774162, ...,  9.146451  ,
          9.146451  ,  9.146451  ],
        [11.07774162, 11.07774162, 11.07774162, ...,  9.146451  ,
          9.146451  ,  9.146451  ],
        ...,
        [ 0.        ,  0.        ,  0.        , ..., 10.41838837,
         10.41838837, 10.41838837],
        [ 0.        ,  0.        ,  0.        , ..., 10.41838837,
         10.41838837, 10.41838837],
        [ 0.        ,  0.        ,  0.        , ..., 10.41838837,
         10.41838837, 10.41838837]], shape=(75, 82))}
</pre></div></div>
</div>
<p>Potetial evapotranspiration and Precipitation data from daymet are in mm/day, however our discretization is meters/day.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prcp_monthly</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="o">*</span> <span class="mf">0.001</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">prcp_monthly</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
<span class="n">pet_monthly</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="o">*</span> <span class="mf">0.001</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">pet_monthly</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
</pre></div>
</div>
</div>
<p>Finally we can load a saved soil hydraulic conductivity array, and we have the information we need to create a Unsaturated Zone Flow (UZF) package for this model</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ksat_raster</span> <span class="o">=</span> <span class="n">data_path</span> <span class="o">/</span> <span class="s2">&quot;ksat.img&quot;</span>
<span class="n">rstr</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">Raster</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">ksat_raster</span><span class="p">)</span>
<span class="n">vks</span> <span class="o">=</span> <span class="n">rstr</span><span class="o">.</span><span class="n">resample_to_grid</span><span class="p">(</span>
    <span class="n">modelgrid</span><span class="p">,</span>
    <span class="n">rstr</span><span class="o">.</span><span class="n">bands</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">method</span><span class="o">=</span><span class="s2">&quot;nearest&quot;</span>
<span class="p">)</span>

<span class="n">vks</span><span class="p">[</span><span class="n">vks</span> <span class="o">==</span> <span class="n">rstr</span><span class="o">.</span><span class="n">nodatavals</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">vks</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">vks</span><span class="p">)]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">vks</span><span class="p">)</span>
<span class="n">vks</span> <span class="o">*=</span> <span class="mf">0.0864</span>
<span class="n">ims</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">vks</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">shrink</span><span class="o">=</span><span class="mf">0.6</span><span class="p">);</span> <span class="c1"># um per sec to m per day</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_part1_flopy_solutions_04_Modelgrid_and_intersection_solution_85_0.png" src="../../../_images/notebooks_part1_flopy_solutions_04_Modelgrid_and_intersection_solution_85_0.png" />
</div>
</div>
<section id="Creating-a-UZF-package">
<h3>Creating a UZF package<a class="headerlink" href="#Creating-a-UZF-package" title="Link to this heading">¶</a></h3>
<p>Now that we have some climate and soils data we can create a UZF package from it and add it to the model!</p>
<p>Create the package data and the stress period data info for flopy</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modelgrid</span> <span class="o">=</span> <span class="n">gwf</span><span class="o">.</span><span class="n">modelgrid</span>
<span class="n">modelgrid</span><span class="o">.</span><span class="n">set_coord_info</span><span class="p">(</span><span class="n">xoff</span><span class="o">=</span><span class="n">xmin</span><span class="p">,</span> <span class="n">yoff</span><span class="o">=</span><span class="n">ymin</span><span class="p">)</span>
<span class="n">package_data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">modelgrid</span><span class="o">.</span><span class="n">nrow</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">modelgrid</span><span class="o">.</span><span class="n">ncol</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">modelgrid</span><span class="o">.</span><span class="n">idomain</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="n">rec</span> <span class="o">=</span> <span class="p">(</span><span class="n">cnt</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">vks</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">)</span>
        <span class="n">package_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span>
        <span class="n">cnt</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="n">period_data</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">per</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">gwf</span><span class="o">.</span><span class="n">nper</span><span class="p">):</span>
    <span class="n">spd</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">modelgrid</span><span class="o">.</span><span class="n">nrow</span> <span class="o">*</span> <span class="n">modelgrid</span><span class="o">.</span><span class="n">ncol</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">modelgrid</span><span class="o">.</span><span class="n">idomain</span><span class="o">.</span><span class="n">ravel</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">rec</span> <span class="o">=</span> <span class="p">(</span><span class="n">cnt</span><span class="p">,</span> <span class="n">prcp_monthly</span><span class="p">[</span><span class="n">per</span><span class="p">]</span><span class="o">.</span><span class="n">ravel</span><span class="p">()[</span><span class="n">i</span><span class="p">],</span> <span class="n">pet_monthly</span><span class="p">[</span><span class="n">per</span><span class="p">]</span><span class="o">.</span><span class="n">ravel</span><span class="p">()[</span><span class="n">i</span><span class="p">],</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="o">-</span><span class="mi">75</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="n">spd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span>
        <span class="n">cnt</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">period_data</span><span class="p">[</span><span class="n">per</span><span class="p">]</span> <span class="o">=</span> <span class="n">spd</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uzf</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">ModflowGwfuzf</span><span class="p">(</span>
    <span class="n">gwf</span><span class="p">,</span>
    <span class="n">simulate_et</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">ntrailwaves</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="n">nwavesets</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">packagedata</span><span class="o">=</span><span class="n">package_data</span><span class="p">,</span>
    <span class="n">perioddata</span><span class="o">=</span><span class="n">period_data</span><span class="p">,</span>
    <span class="n">unsat_etwc</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">linear_gwet</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">simulate_gwseep</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<section id="Now-to-create-a-simple-river-package-from-NHD-flowlines">
<h4>Now to create a simple river package from NHD flowlines<a class="headerlink" href="#Now-to-create-a-simple-river-package-from-NHD-flowlines" title="Link to this heading">¶</a></h4>
<p>We can use the intersection routines that have been presented thus far to create a river package for the sagehen model.</p>
<p>The first step is load the NHD flowlines for the basin</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flow_lines</span> <span class="o">=</span> <span class="n">data_path</span> <span class="o">/</span> <span class="s2">&quot;sagehen_nhd.shp&quot;</span>
<span class="n">flw_all</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">flow_lines</span><span class="p">)</span>
<span class="n">flw_all</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_part1_flopy_solutions_04_Modelgrid_and_intersection_solution_91_0.png" src="../../../_images/notebooks_part1_flopy_solutions_04_Modelgrid_and_intersection_solution_91_0.png" />
</div>
</div>
<p>Excellent! Now we have all of the flow lines for the Sagehen watershed. But what if we want to identify the main stem?</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flow_lines</span> <span class="o">=</span> <span class="n">data_path</span> <span class="o">/</span> <span class="s2">&quot;sagehen_main_nhd.shp&quot;</span>
<span class="n">flw_main</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">flow_lines</span><span class="p">)</span>
<span class="n">flw_main</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">flw_main</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>nhdplus_co</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>8933522</td>
      <td>LINESTRING (221038.128 4369598.916, 221076.482...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>8933524</td>
      <td>LINESTRING (220540.741 4369697.577, 220691.351...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8933520</td>
      <td>LINESTRING (220240.365 4369758.86, 220244.995 ...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>8934344</td>
      <td>LINESTRING (219769.843 4369876.335, 219795.329...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>8933512</td>
      <td>LINESTRING (219321.052 4369977.09, 219357.89 4...</td>
    </tr>
    <tr>
      <th>5</th>
      <td>8933508</td>
      <td>LINESTRING (218509.989 4370180.464, 218578.637...</td>
    </tr>
    <tr>
      <th>6</th>
      <td>8933496</td>
      <td>LINESTRING (217726.838 4370179.373, 217746.044...</td>
    </tr>
    <tr>
      <th>7</th>
      <td>8933582</td>
      <td>LINESTRING (215175.791 4368533.473, 215195.962...</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_part1_flopy_solutions_04_Modelgrid_and_intersection_solution_93_1.png" src="../../../_images/notebooks_part1_flopy_solutions_04_Modelgrid_and_intersection_solution_93_1.png" />
</div>
</div>
<p>Great! Now we can start processing data to create a river package. We can first identify our main stem cells.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">main_stem</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">gx</span> <span class="o">=</span> <span class="n">GridIntersect</span><span class="p">(</span><span class="n">modelgrid</span><span class="p">)</span>
<span class="k">for</span> <span class="n">iloc</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">flw_main</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">gx</span><span class="o">.</span><span class="n">intersect</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">geometry</span><span class="p">)</span>
    <span class="n">main_stem</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">cellids</span><span class="p">)</span>
<span class="n">main_stem</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/mnfienen/miniforge3/envs/pyclass/lib/python3.11/site-packages/flopy/utils/gridintersect.py:123: DeprecationWarning: Note `method=&#34;structured&#34;` is deprecated. Pass `method=&#34;vertex&#34;` to silence this warning. This will be the new default in a future release and this keyword argument will be removed.
  warnings.warn(
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[(42, 75), (42, 76), (41, 76), (41, 77), (41, 78)]
</pre></div></div>
</div>
</section>
</section>
</section>
<section id="Class-Exercise:">
<h2>Class Exercise:<a class="headerlink" href="#Class-Exercise:" title="Link to this heading">¶</a></h2>
<p>Use GridIntersect to create a list of tributary cells from the <code class="docutils literal notranslate"><span class="pre">flw_all</span></code> geodataframe.</p>
<p><strong>Hint</strong> Use the <code class="docutils literal notranslate"><span class="pre">main_stem</span></code> list to filter out cells that are associated with the main stem of the river and only store the cells that are associated with tributaries to the main stem.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tributaries</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">gx</span> <span class="o">=</span> <span class="n">GridIntersect</span><span class="p">(</span><span class="n">modelgrid</span><span class="p">)</span>
<span class="k">for</span> <span class="n">iloc</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">flw_all</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">gx</span><span class="o">.</span><span class="n">intersect</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">geometry</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">results</span><span class="o">.</span><span class="n">cellids</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">main_stem</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tributaries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>

<span class="n">tributaries</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">data_path</span> <span class="o">/</span> <span class="s2">&quot;trib_cells.txt&quot;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">foo</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">tributaries</span><span class="p">:</span>
        <span class="n">foo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/mnfienen/miniforge3/envs/pyclass/lib/python3.11/site-packages/flopy/utils/gridintersect.py:123: DeprecationWarning: Note `method=&#34;structured&#34;` is deprecated. Pass `method=&#34;vertex&#34;` to silence this warning. This will be the new default in a future release and this keyword argument will be removed.
  warnings.warn(
</pre></div></div>
</div>
<p>The cellids for tributaries have been stored previously, so we’ll load those up and continue on.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tributaries</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">data_path</span> <span class="o">/</span> <span class="s2">&quot;trib_cells.txt&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">foo</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">foo</span><span class="p">:</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
        <span class="n">tributaries</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span>
</pre></div>
</div>
</div>
<section id="We-can-also-get-daily-discharge-data-to-help-calculate-average-monthly-stages-for-the-RIV-package">
<h3>We can also get daily discharge data to help calculate average monthly stages for the RIV package<a class="headerlink" href="#We-can-also-get-daily-discharge-data-to-help-calculate-average-monthly-stages-for-the-RIV-package" title="Link to this heading">¶</a></h3>
<p>We’ll use the <code class="docutils literal notranslate"><span class="pre">dataretrieval</span></code> package to get stage information for our model</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">dataretrieval.nwis</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nwis</span>


<span class="n">gage</span> <span class="o">=</span> <span class="n">nwis</span><span class="o">.</span><span class="n">get_record</span><span class="p">(</span><span class="n">sites</span><span class="o">=</span><span class="n">station_id</span><span class="p">,</span> <span class="n">service</span><span class="o">=</span><span class="s1">&#39;iv&#39;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="s2">&quot;2023-01-01&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;2023-12-31&quot;</span><span class="p">,</span> <span class="n">parameterCd</span><span class="o">=</span><span class="s2">&quot;00065&quot;</span><span class="p">)</span>
<span class="n">gage</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">data_path</span> <span class="o">/</span> <span class="s2">&quot;sagehen_gage_data.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gage</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">data_path</span> <span class="o">/</span> <span class="s2">&quot;sagehen_gage_data.csv&quot;</span><span class="p">)</span>
<span class="n">gage</span><span class="p">[</span><span class="s2">&quot;datetime&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">gage</span><span class="p">[</span><span class="s2">&quot;datetime&quot;</span><span class="p">])</span>
<span class="n">gage</span> <span class="o">=</span> <span class="n">gage</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;datetime&quot;</span><span class="p">)</span>

<span class="n">gage</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;00065&quot;</span><span class="p">:</span> <span class="s2">&quot;stage&quot;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">gage</span><span class="o">.</span><span class="n">stage</span> <span class="o">*=</span> <span class="mf">0.3284</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">gage</span><span class="o">.</span><span class="n">stage</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;stage, in feet&quot;</span><span class="p">)</span>
<span class="n">gage</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>site_no</th>
      <th>stage</th>
      <th>00065_cd</th>
    </tr>
    <tr>
      <th>datetime</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2023-01-01 08:00:00+00:00</th>
      <td>10343500</td>
      <td>0.748752</td>
      <td>A</td>
    </tr>
    <tr>
      <th>2023-01-01 08:15:00+00:00</th>
      <td>10343500</td>
      <td>0.748752</td>
      <td>A</td>
    </tr>
    <tr>
      <th>2023-01-01 08:30:00+00:00</th>
      <td>10343500</td>
      <td>0.748752</td>
      <td>A</td>
    </tr>
    <tr>
      <th>2023-01-01 08:45:00+00:00</th>
      <td>10343500</td>
      <td>0.748752</td>
      <td>A</td>
    </tr>
    <tr>
      <th>2023-01-01 09:00:00+00:00</th>
      <td>10343500</td>
      <td>0.748752</td>
      <td>A</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_part1_flopy_solutions_04_Modelgrid_and_intersection_solution_102_1.png" src="../../../_images/notebooks_part1_flopy_solutions_04_Modelgrid_and_intersection_solution_102_1.png" />
</div>
</div>
<p>Now we can aggregate to a mean monthly stage from 15 minute instantaneous values</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gage</span><span class="p">[</span><span class="s2">&quot;month&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gage</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">month</span>
<span class="n">gage_mmo</span> <span class="o">=</span> <span class="n">gage</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;month&quot;</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s2">&quot;stage&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">gage_mmo</span><span class="o">.</span><span class="n">stage</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;mean stage, in feet&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_part1_flopy_solutions_04_Modelgrid_and_intersection_solution_104_0.png" src="../../../_images/notebooks_part1_flopy_solutions_04_Modelgrid_and_intersection_solution_104_0.png" />
</div>
</div>
<section id="Now-to-create-the-RIV-package">
<h4>Now to create the RIV package<a class="headerlink" href="#Now-to-create-the-RIV-package" title="Link to this heading">¶</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[56]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cond</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">rbadj</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">stage_adj</span> <span class="o">=</span> <span class="mf">0.33</span>

<span class="n">perioddata</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">kper</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">gage_mmo</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">spd</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="ow">in</span> <span class="n">main_stem</span><span class="p">:</span>
        <span class="n">ctop</span> <span class="o">=</span> <span class="n">modelgrid</span><span class="o">.</span><span class="n">top</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
        <span class="n">rbed</span> <span class="o">=</span> <span class="n">ctop</span> <span class="o">-</span> <span class="n">rbadj</span>
        <span class="n">rec</span> <span class="o">=</span> <span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">),</span> <span class="n">row</span><span class="o">.</span><span class="n">stage</span> <span class="o">+</span> <span class="n">rbed</span><span class="p">,</span> <span class="n">cond</span><span class="p">,</span> <span class="n">rbed</span><span class="p">)</span>
        <span class="n">spd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span>

    <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="ow">in</span> <span class="n">tributaries</span><span class="p">:</span>
        <span class="n">ctop</span> <span class="o">=</span> <span class="n">modelgrid</span><span class="o">.</span><span class="n">top</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
        <span class="n">rbed</span> <span class="o">=</span> <span class="n">ctop</span> <span class="o">-</span> <span class="p">(</span><span class="n">rbadj</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">rec</span> <span class="o">=</span> <span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">),</span> <span class="n">row</span><span class="o">.</span><span class="n">stage</span> <span class="o">+</span> <span class="n">rbed</span><span class="p">,</span> <span class="n">cond</span><span class="p">,</span> <span class="n">rbed</span><span class="p">)</span>

    <span class="n">perioddata</span><span class="p">[</span><span class="n">kper</span><span class="p">]</span> <span class="o">=</span> <span class="n">spd</span>

<span class="n">perioddata</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[56]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[((0, 42, 75),
  np.float64(1936.8217418655074),
  10,
  np.float64(1936.2347412109375)),
 ((0, 42, 76), np.float64(1935.65633659207), 10, np.float64(1935.0693359375)),
 ((0, 41, 76),
  np.float64(1932.400721357695),
  10,
  np.float64(1931.813720703125)),
 ((0, 41, 77),
  np.float64(1930.8251598342574),
  10,
  np.float64(1930.2381591796875)),
 ((0, 41, 78), np.float64(1928.34823112332), 10, np.float64(1927.76123046875))]
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[57]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">riv</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">ModflowGwfriv</span><span class="p">(</span>
    <span class="n">gwf</span><span class="p">,</span>
    <span class="n">save_flows</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">maxbound</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">perioddata</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
    <span class="n">stress_period_data</span><span class="o">=</span><span class="n">perioddata</span>
<span class="p">)</span>
<br/></pre></div>
</div>
</div>
</section>
</section>
</section>
<section id="Testing-the-model">
<h2>Testing the model<a class="headerlink" href="#Testing-the-model" title="Link to this heading">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[58]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">write_simulation</span><span class="p">()</span>
<span class="n">sim</span><span class="o">.</span><span class="n">run_simulation</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
writing simulation...
  writing simulation name file...
  writing simulation tdis package...
  writing solution package ims_-1...
  writing model sagehen...
    writing model name file...
    writing package dis...
    writing package ic...
    writing package npf...
    writing package sto...
    writing package oc...
    writing package uzf_0...
INFORMATION: nuzfcells in (&#39;gwf6&#39;, &#39;uzf&#39;, &#39;dimensions&#39;) changed to 3587 based on size of packagedata
    writing package riv_0...
FloPy is using the following executable to run the model: ../../../../../../../.local/share/flopy/bin/mf6
                                   MODFLOW 6
                U.S. GEOLOGICAL SURVEY MODULAR HYDROLOGIC MODEL
                            VERSION 6.4.2 06/28/2023

   MODFLOW 6 compiled Jul 05 2023 20:29:14 with Intel(R) Fortran Intel(R) 64
   Compiler Classic for applications running on Intel(R) 64, Version 2021.7.0
                             Build 20220726_000000

This software has been approved for release by the U.S. Geological
Survey (USGS). Although the software has been subjected to rigorous
review, the USGS reserves the right to update the software as needed
pursuant to further analysis and review. No warranty, expressed or
implied, is made by the USGS or the U.S. Government as to the
functionality of the software and related material nor shall the
fact of release constitute any such warranty. Furthermore, the
software is released on condition that neither the USGS nor the U.S.
Government shall be held liable for any damages resulting from its
authorized or unauthorized use. Also refer to the USGS Water
Resources Software User Rights Notice for complete use, copyright,
and distribution information.


 Run start date and time (yyyy/mm/dd hh:mm:ss): 2025/04/27 10:59:44

 Writing simulation list file: mfsim.lst
 Using Simulation name file: mfsim.nam

    Solving:  Stress period:     1    Time step:     1
    Solving:  Stress period:     1    Time step:     2
    Solving:  Stress period:     1    Time step:     3
    Solving:  Stress period:     1    Time step:     4
    Solving:  Stress period:     1    Time step:     5
    Solving:  Stress period:     1    Time step:     6
    Solving:  Stress period:     1    Time step:     7
    Solving:  Stress period:     1    Time step:     8
    Solving:  Stress period:     1    Time step:     9
    Solving:  Stress period:     1    Time step:    10
    Solving:  Stress period:     1    Time step:    11
    Solving:  Stress period:     1    Time step:    12
    Solving:  Stress period:     1    Time step:    13
    Solving:  Stress period:     1    Time step:    14
    Solving:  Stress period:     1    Time step:    15
    Solving:  Stress period:     1    Time step:    16
    Solving:  Stress period:     1    Time step:    17
    Solving:  Stress period:     1    Time step:    18
    Solving:  Stress period:     1    Time step:    19
    Solving:  Stress period:     1    Time step:    20
    Solving:  Stress period:     1    Time step:    21
    Solving:  Stress period:     1    Time step:    22
    Solving:  Stress period:     1    Time step:    23
    Solving:  Stress period:     1    Time step:    24
    Solving:  Stress period:     1    Time step:    25
    Solving:  Stress period:     1    Time step:    26
    Solving:  Stress period:     1    Time step:    27
    Solving:  Stress period:     1    Time step:    28
    Solving:  Stress period:     1    Time step:    29
    Solving:  Stress period:     1    Time step:    30
    Solving:  Stress period:     1    Time step:    31
    Solving:  Stress period:     2    Time step:     1
    Solving:  Stress period:     2    Time step:     2
    Solving:  Stress period:     2    Time step:     3
    Solving:  Stress period:     2    Time step:     4
    Solving:  Stress period:     2    Time step:     5
    Solving:  Stress period:     2    Time step:     6
    Solving:  Stress period:     2    Time step:     7
    Solving:  Stress period:     2    Time step:     8
    Solving:  Stress period:     2    Time step:     9
    Solving:  Stress period:     2    Time step:    10
    Solving:  Stress period:     2    Time step:    11
    Solving:  Stress period:     2    Time step:    12
    Solving:  Stress period:     2    Time step:    13
    Solving:  Stress period:     2    Time step:    14
    Solving:  Stress period:     2    Time step:    15
    Solving:  Stress period:     2    Time step:    16
    Solving:  Stress period:     2    Time step:    17
    Solving:  Stress period:     2    Time step:    18
    Solving:  Stress period:     2    Time step:    19
    Solving:  Stress period:     2    Time step:    20
    Solving:  Stress period:     2    Time step:    21
    Solving:  Stress period:     2    Time step:    22
    Solving:  Stress period:     2    Time step:    23
    Solving:  Stress period:     2    Time step:    24
    Solving:  Stress period:     2    Time step:    25
    Solving:  Stress period:     2    Time step:    26
    Solving:  Stress period:     2    Time step:    27
    Solving:  Stress period:     2    Time step:    28
    Solving:  Stress period:     3    Time step:     1
    Solving:  Stress period:     3    Time step:     2
    Solving:  Stress period:     3    Time step:     3
    Solving:  Stress period:     3    Time step:     4
    Solving:  Stress period:     3    Time step:     5
    Solving:  Stress period:     3    Time step:     6
    Solving:  Stress period:     3    Time step:     7
    Solving:  Stress period:     3    Time step:     8
    Solving:  Stress period:     3    Time step:     9
    Solving:  Stress period:     3    Time step:    10
    Solving:  Stress period:     3    Time step:    11
    Solving:  Stress period:     3    Time step:    12
    Solving:  Stress period:     3    Time step:    13
    Solving:  Stress period:     3    Time step:    14
    Solving:  Stress period:     3    Time step:    15
    Solving:  Stress period:     3    Time step:    16
    Solving:  Stress period:     3    Time step:    17
    Solving:  Stress period:     3    Time step:    18
    Solving:  Stress period:     3    Time step:    19
    Solving:  Stress period:     3    Time step:    20
    Solving:  Stress period:     3    Time step:    21
    Solving:  Stress period:     3    Time step:    22
    Solving:  Stress period:     3    Time step:    23
    Solving:  Stress period:     3    Time step:    24
    Solving:  Stress period:     3    Time step:    25
    Solving:  Stress period:     3    Time step:    26
    Solving:  Stress period:     3    Time step:    27
    Solving:  Stress period:     3    Time step:    28
    Solving:  Stress period:     3    Time step:    29
    Solving:  Stress period:     3    Time step:    30
    Solving:  Stress period:     3    Time step:    31
    Solving:  Stress period:     4    Time step:     1
    Solving:  Stress period:     4    Time step:     2
    Solving:  Stress period:     4    Time step:     3
    Solving:  Stress period:     4    Time step:     4
    Solving:  Stress period:     4    Time step:     5
    Solving:  Stress period:     4    Time step:     6
    Solving:  Stress period:     4    Time step:     7
    Solving:  Stress period:     4    Time step:     8
    Solving:  Stress period:     4    Time step:     9
    Solving:  Stress period:     4    Time step:    10
    Solving:  Stress period:     4    Time step:    11
    Solving:  Stress period:     4    Time step:    12
    Solving:  Stress period:     4    Time step:    13
    Solving:  Stress period:     4    Time step:    14
    Solving:  Stress period:     4    Time step:    15
    Solving:  Stress period:     4    Time step:    16
    Solving:  Stress period:     4    Time step:    17
    Solving:  Stress period:     4    Time step:    18
    Solving:  Stress period:     4    Time step:    19
    Solving:  Stress period:     4    Time step:    20
    Solving:  Stress period:     4    Time step:    21
    Solving:  Stress period:     4    Time step:    22
    Solving:  Stress period:     4    Time step:    23
    Solving:  Stress period:     4    Time step:    24
    Solving:  Stress period:     4    Time step:    25
    Solving:  Stress period:     4    Time step:    26
    Solving:  Stress period:     4    Time step:    27
    Solving:  Stress period:     4    Time step:    28
    Solving:  Stress period:     4    Time step:    29
    Solving:  Stress period:     4    Time step:    30
    Solving:  Stress period:     5    Time step:     1
    Solving:  Stress period:     5    Time step:     2
    Solving:  Stress period:     5    Time step:     3
    Solving:  Stress period:     5    Time step:     4
    Solving:  Stress period:     5    Time step:     5
    Solving:  Stress period:     5    Time step:     6
    Solving:  Stress period:     5    Time step:     7
    Solving:  Stress period:     5    Time step:     8
    Solving:  Stress period:     5    Time step:     9
    Solving:  Stress period:     5    Time step:    10
    Solving:  Stress period:     5    Time step:    11
    Solving:  Stress period:     5    Time step:    12
    Solving:  Stress period:     5    Time step:    13
    Solving:  Stress period:     5    Time step:    14
    Solving:  Stress period:     5    Time step:    15
    Solving:  Stress period:     5    Time step:    16
    Solving:  Stress period:     5    Time step:    17
    Solving:  Stress period:     5    Time step:    18
    Solving:  Stress period:     5    Time step:    19
    Solving:  Stress period:     5    Time step:    20
    Solving:  Stress period:     5    Time step:    21
    Solving:  Stress period:     5    Time step:    22
    Solving:  Stress period:     5    Time step:    23
    Solving:  Stress period:     5    Time step:    24
    Solving:  Stress period:     5    Time step:    25
    Solving:  Stress period:     5    Time step:    26
    Solving:  Stress period:     5    Time step:    27
    Solving:  Stress period:     5    Time step:    28
    Solving:  Stress period:     5    Time step:    29
    Solving:  Stress period:     5    Time step:    30
    Solving:  Stress period:     5    Time step:    31
    Solving:  Stress period:     6    Time step:     1
    Solving:  Stress period:     6    Time step:     2
    Solving:  Stress period:     6    Time step:     3
    Solving:  Stress period:     6    Time step:     4
    Solving:  Stress period:     6    Time step:     5
    Solving:  Stress period:     6    Time step:     6
    Solving:  Stress period:     6    Time step:     7
    Solving:  Stress period:     6    Time step:     8
    Solving:  Stress period:     6    Time step:     9
    Solving:  Stress period:     6    Time step:    10
    Solving:  Stress period:     6    Time step:    11
    Solving:  Stress period:     6    Time step:    12
    Solving:  Stress period:     6    Time step:    13
    Solving:  Stress period:     6    Time step:    14
    Solving:  Stress period:     6    Time step:    15
    Solving:  Stress period:     6    Time step:    16
    Solving:  Stress period:     6    Time step:    17
    Solving:  Stress period:     6    Time step:    18
    Solving:  Stress period:     6    Time step:    19
    Solving:  Stress period:     6    Time step:    20
    Solving:  Stress period:     6    Time step:    21
    Solving:  Stress period:     6    Time step:    22
    Solving:  Stress period:     6    Time step:    23
    Solving:  Stress period:     6    Time step:    24
    Solving:  Stress period:     6    Time step:    25
    Solving:  Stress period:     6    Time step:    26
    Solving:  Stress period:     6    Time step:    27
    Solving:  Stress period:     6    Time step:    28
    Solving:  Stress period:     6    Time step:    29
    Solving:  Stress period:     6    Time step:    30
    Solving:  Stress period:     7    Time step:     1
    Solving:  Stress period:     7    Time step:     2
    Solving:  Stress period:     7    Time step:     3
    Solving:  Stress period:     7    Time step:     4
    Solving:  Stress period:     7    Time step:     5
    Solving:  Stress period:     7    Time step:     6
    Solving:  Stress period:     7    Time step:     7
    Solving:  Stress period:     7    Time step:     8
    Solving:  Stress period:     7    Time step:     9
    Solving:  Stress period:     7    Time step:    10
    Solving:  Stress period:     7    Time step:    11
    Solving:  Stress period:     7    Time step:    12
    Solving:  Stress period:     7    Time step:    13
    Solving:  Stress period:     7    Time step:    14
    Solving:  Stress period:     7    Time step:    15
    Solving:  Stress period:     7    Time step:    16
    Solving:  Stress period:     7    Time step:    17
    Solving:  Stress period:     7    Time step:    18
    Solving:  Stress period:     7    Time step:    19
    Solving:  Stress period:     7    Time step:    20
    Solving:  Stress period:     7    Time step:    21
    Solving:  Stress period:     7    Time step:    22
    Solving:  Stress period:     7    Time step:    23
    Solving:  Stress period:     7    Time step:    24
    Solving:  Stress period:     7    Time step:    25
    Solving:  Stress period:     7    Time step:    26
    Solving:  Stress period:     7    Time step:    27
    Solving:  Stress period:     7    Time step:    28
    Solving:  Stress period:     7    Time step:    29
    Solving:  Stress period:     7    Time step:    30
    Solving:  Stress period:     7    Time step:    31
    Solving:  Stress period:     8    Time step:     1
    Solving:  Stress period:     8    Time step:     2
    Solving:  Stress period:     8    Time step:     3
    Solving:  Stress period:     8    Time step:     4
    Solving:  Stress period:     8    Time step:     5
    Solving:  Stress period:     8    Time step:     6
    Solving:  Stress period:     8    Time step:     7
    Solving:  Stress period:     8    Time step:     8
    Solving:  Stress period:     8    Time step:     9
    Solving:  Stress period:     8    Time step:    10
    Solving:  Stress period:     8    Time step:    11
    Solving:  Stress period:     8    Time step:    12
    Solving:  Stress period:     8    Time step:    13
    Solving:  Stress period:     8    Time step:    14
    Solving:  Stress period:     8    Time step:    15
    Solving:  Stress period:     8    Time step:    16
    Solving:  Stress period:     8    Time step:    17
    Solving:  Stress period:     8    Time step:    18
    Solving:  Stress period:     8    Time step:    19
    Solving:  Stress period:     8    Time step:    20
    Solving:  Stress period:     8    Time step:    21
    Solving:  Stress period:     8    Time step:    22
    Solving:  Stress period:     8    Time step:    23
    Solving:  Stress period:     8    Time step:    24
    Solving:  Stress period:     8    Time step:    25
    Solving:  Stress period:     8    Time step:    26
    Solving:  Stress period:     8    Time step:    27
    Solving:  Stress period:     8    Time step:    28
    Solving:  Stress period:     8    Time step:    29
    Solving:  Stress period:     8    Time step:    30
    Solving:  Stress period:     8    Time step:    31
    Solving:  Stress period:     9    Time step:     1
    Solving:  Stress period:     9    Time step:     2
    Solving:  Stress period:     9    Time step:     3
    Solving:  Stress period:     9    Time step:     4
    Solving:  Stress period:     9    Time step:     5
    Solving:  Stress period:     9    Time step:     6
    Solving:  Stress period:     9    Time step:     7
    Solving:  Stress period:     9    Time step:     8
    Solving:  Stress period:     9    Time step:     9
    Solving:  Stress period:     9    Time step:    10
    Solving:  Stress period:     9    Time step:    11
    Solving:  Stress period:     9    Time step:    12
    Solving:  Stress period:     9    Time step:    13
    Solving:  Stress period:     9    Time step:    14
    Solving:  Stress period:     9    Time step:    15
    Solving:  Stress period:     9    Time step:    16
    Solving:  Stress period:     9    Time step:    17
    Solving:  Stress period:     9    Time step:    18
    Solving:  Stress period:     9    Time step:    19
    Solving:  Stress period:     9    Time step:    20
    Solving:  Stress period:     9    Time step:    21
    Solving:  Stress period:     9    Time step:    22
    Solving:  Stress period:     9    Time step:    23
    Solving:  Stress period:     9    Time step:    24
    Solving:  Stress period:     9    Time step:    25
    Solving:  Stress period:     9    Time step:    26
    Solving:  Stress period:     9    Time step:    27
    Solving:  Stress period:     9    Time step:    28
    Solving:  Stress period:     9    Time step:    29
    Solving:  Stress period:     9    Time step:    30
    Solving:  Stress period:    10    Time step:     1
    Solving:  Stress period:    10    Time step:     2
    Solving:  Stress period:    10    Time step:     3
    Solving:  Stress period:    10    Time step:     4
    Solving:  Stress period:    10    Time step:     5
    Solving:  Stress period:    10    Time step:     6
    Solving:  Stress period:    10    Time step:     7
    Solving:  Stress period:    10    Time step:     8
    Solving:  Stress period:    10    Time step:     9
    Solving:  Stress period:    10    Time step:    10
    Solving:  Stress period:    10    Time step:    11
    Solving:  Stress period:    10    Time step:    12
    Solving:  Stress period:    10    Time step:    13
    Solving:  Stress period:    10    Time step:    14
    Solving:  Stress period:    10    Time step:    15
    Solving:  Stress period:    10    Time step:    16
    Solving:  Stress period:    10    Time step:    17
    Solving:  Stress period:    10    Time step:    18
    Solving:  Stress period:    10    Time step:    19
    Solving:  Stress period:    10    Time step:    20
    Solving:  Stress period:    10    Time step:    21
    Solving:  Stress period:    10    Time step:    22
    Solving:  Stress period:    10    Time step:    23
    Solving:  Stress period:    10    Time step:    24
    Solving:  Stress period:    10    Time step:    25
    Solving:  Stress period:    10    Time step:    26
    Solving:  Stress period:    10    Time step:    27
    Solving:  Stress period:    10    Time step:    28
    Solving:  Stress period:    10    Time step:    29
    Solving:  Stress period:    10    Time step:    30
    Solving:  Stress period:    10    Time step:    31
    Solving:  Stress period:    11    Time step:     1
    Solving:  Stress period:    11    Time step:     2
    Solving:  Stress period:    11    Time step:     3
    Solving:  Stress period:    11    Time step:     4
    Solving:  Stress period:    11    Time step:     5
    Solving:  Stress period:    11    Time step:     6
    Solving:  Stress period:    11    Time step:     7
    Solving:  Stress period:    11    Time step:     8
    Solving:  Stress period:    11    Time step:     9
    Solving:  Stress period:    11    Time step:    10
    Solving:  Stress period:    11    Time step:    11
    Solving:  Stress period:    11    Time step:    12
    Solving:  Stress period:    11    Time step:    13
    Solving:  Stress period:    11    Time step:    14
    Solving:  Stress period:    11    Time step:    15
    Solving:  Stress period:    11    Time step:    16
    Solving:  Stress period:    11    Time step:    17
    Solving:  Stress period:    11    Time step:    18
    Solving:  Stress period:    11    Time step:    19
    Solving:  Stress period:    11    Time step:    20
    Solving:  Stress period:    11    Time step:    21
    Solving:  Stress period:    11    Time step:    22
    Solving:  Stress period:    11    Time step:    23
    Solving:  Stress period:    11    Time step:    24
    Solving:  Stress period:    11    Time step:    25
    Solving:  Stress period:    11    Time step:    26
    Solving:  Stress period:    11    Time step:    27
    Solving:  Stress period:    11    Time step:    28
    Solving:  Stress period:    11    Time step:    29
    Solving:  Stress period:    11    Time step:    30
    Solving:  Stress period:    12    Time step:     1
    Solving:  Stress period:    12    Time step:     2
    Solving:  Stress period:    12    Time step:     3
    Solving:  Stress period:    12    Time step:     4
    Solving:  Stress period:    12    Time step:     5
    Solving:  Stress period:    12    Time step:     6
    Solving:  Stress period:    12    Time step:     7
    Solving:  Stress period:    12    Time step:     8
    Solving:  Stress period:    12    Time step:     9
    Solving:  Stress period:    12    Time step:    10
    Solving:  Stress period:    12    Time step:    11
    Solving:  Stress period:    12    Time step:    12
    Solving:  Stress period:    12    Time step:    13
    Solving:  Stress period:    12    Time step:    14
    Solving:  Stress period:    12    Time step:    15
    Solving:  Stress period:    12    Time step:    16
    Solving:  Stress period:    12    Time step:    17
    Solving:  Stress period:    12    Time step:    18
    Solving:  Stress period:    12    Time step:    19
    Solving:  Stress period:    12    Time step:    20
    Solving:  Stress period:    12    Time step:    21
    Solving:  Stress period:    12    Time step:    22
    Solving:  Stress period:    12    Time step:    23
    Solving:  Stress period:    12    Time step:    24
    Solving:  Stress period:    12    Time step:    25
    Solving:  Stress period:    12    Time step:    26
    Solving:  Stress period:    12    Time step:    27
    Solving:  Stress period:    12    Time step:    28
    Solving:  Stress period:    12    Time step:    29
    Solving:  Stress period:    12    Time step:    30
    Solving:  Stress period:    12    Time step:    31

 Run end date and time (yyyy/mm/dd hh:mm:ss): 2025/04/27 11:00:56
 Elapsed run time:  1 Minutes, 11.569 Seconds

 Normal termination of simulation.
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[59]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hds</span> <span class="o">=</span> <span class="n">gwf</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="n">heads</span> <span class="o">=</span> <span class="n">hds</span><span class="o">.</span><span class="n">get_alldata</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">pmv</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">PlotMapView</span><span class="p">(</span><span class="n">modelgrid</span><span class="o">=</span><span class="n">modelgrid</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">pc</span> <span class="o">=</span> <span class="n">pmv</span><span class="o">.</span><span class="n">plot_array</span><span class="p">(</span><span class="n">heads</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">masked_values</span><span class="o">=</span><span class="p">[</span><span class="mf">1e30</span><span class="p">,</span> <span class="o">-</span><span class="mf">1e30</span><span class="p">])</span>
<span class="n">pmv</span><span class="o">.</span><span class="n">plot_grid</span><span class="p">(</span><span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">pmv</span><span class="o">.</span><span class="n">plot_inactive</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">pc</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_part1_flopy_solutions_04_Modelgrid_and_intersection_solution_110_0.png" src="../../../_images/notebooks_part1_flopy_solutions_04_Modelgrid_and_intersection_solution_110_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[60]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
<span class="n">xc</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">PlotCrossSection</span><span class="p">(</span><span class="n">modelgrid</span><span class="o">=</span><span class="n">modelgrid</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;row&quot;</span><span class="p">:</span> <span class="mi">36</span><span class="p">},</span> <span class="n">geographic_coords</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pc</span> <span class="o">=</span> <span class="n">xc</span><span class="o">.</span><span class="n">plot_array</span><span class="p">(</span><span class="n">heads</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;plasma&#39;</span><span class="p">,</span> <span class="n">head</span><span class="o">=</span><span class="n">heads</span><span class="p">,</span> <span class="n">masked_values</span><span class="o">=</span><span class="p">[</span><span class="mf">1e+30</span><span class="p">])</span>
<span class="n">xc</span><span class="o">.</span><span class="n">plot_grid</span><span class="p">(</span><span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">xc</span><span class="o">.</span><span class="n">plot_inactive</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">pc</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.50</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/notebooks_part1_flopy_solutions_04_Modelgrid_and_intersection_solution_111_0.png" src="../../../_images/notebooks_part1_flopy_solutions_04_Modelgrid_and_intersection_solution_111_0.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="03_Loading_and_visualizing_models-solutions.html" class="btn btn-neutral float-left" title="03: Loading and visualizing groundwater models" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../05-unstructured-grids.html" class="btn btn-neutral float-right" title="05: Unstructred Grids" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022-2025, USGS Python for Hydrology instructors.
      <span class="lastupdated">Last updated on Sep 17, 2025.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>